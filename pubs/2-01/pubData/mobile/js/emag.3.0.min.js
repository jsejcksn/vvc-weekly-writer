var FlashDetect=new function(){function a(a){var c=-1;try{c=a.GetVariable("$version")}catch(d){}return c}var c=this;c.installed=!1;c.raw="";c.major=-1;c.minor=-1;c.revision=-1;c.revisionStr="";var d=[{name:"ShockwaveFlash.ShockwaveFlash.7",version:function(c){return a(c)}},{name:"ShockwaveFlash.ShockwaveFlash.6",version:function(c){var e="6,0,21";try{c.AllowScriptAccess="always",e=a(c)}catch(d){}return e}},{name:"ShockwaveFlash.ShockwaveFlash",version:function(c){return a(c)}}];c.majorAtLeast=function(a){return c.major>=
a};c.minorAtLeast=function(a){return c.minor>=a};c.revisionAtLeast=function(a){return c.revision>=a};c.versionAtLeast=function(a){for(var e=[c.major,c.minor,c.revision],d=Math.min(e.length,arguments.length),g=0;g<d;g++)if(e[g]>=arguments[g]){if(!(g+1<d&&e[g]==arguments[g]))return!0}else return!1};(function(){var a,e,j,g,m;if(navigator.plugins&&navigator.plugins.length>0){var i=navigator.mimeTypes;if(i&&i["application/x-shockwave-flash"]&&i["application/x-shockwave-flash"].enabledPlugin&&i["application/x-shockwave-flash"].enabledPlugin.description){a=
i=i["application/x-shockwave-flash"].enabledPlugin.description;var i=a.split(/ +/),b=i[2].split(/\./),i=i[3];e=parseInt(b[0],10);j=parseInt(b[1],10);g=i;m=parseInt(i.replace(/[a-zA-Z]/g,""),10)||c.revision;c.raw=a;c.major=e;c.minor=j;c.revisionStr=g;c.revision=m;c.installed=!0}}else if(navigator.appVersion.indexOf("Mac")==-1&&window.execScript){i=-1;for(b=0;b<d.length&&i==-1;b++){a=-1;try{a=new ActiveXObject(d[b].name)}catch(n){a={activeXError:!0}}if(!a.activeXError&&(c.installed=!0,i=d[b].version(a),
i!=-1))a=i,g=a.split(","),e=parseInt(g[0].split(" ")[1],10),j=parseInt(g[1],10),m=parseInt(g[2],10),g=g[2],c.raw=a,c.major=e,c.minor=j,c.revision=m,c.revisionStr=g}}})()},sp=String.prototype;sp.replaceTags=function(a){var c=this,d;for(d in a)c=c.replace(RegExp("({~"+d+"~})","gm"),a[d]);return c};sp.capitalize=function(){return this[0].toUpperCase()+this.substr(1,this.length).toLowerCase()};
sp.encodeFileName=function(){var a=this.split("/").slice(-1)[0].split("?")[0];return this.replace(a,(a.match(/[/?:@&=+$# ]/)?encodeURIComponent(a):a).replace(/'/g,"%27"))};sp.hex2num=function(){for(var a=[],c=this.slice(-6).toUpperCase(),d=0;d<6;d+=2)a.push("0123456789ABCDEF".indexOf(c.charAt(d))*16+"0123456789ABCDEF".indexOf(c.charAt(d+1)));return a};sp.toHTMLUnicode=function(){for(var a="",c=0,d=0;d<this.length;d++)c=this.charCodeAt(d),a+=c>256?"&#"+c+";":this.charAt(d);return a};
sp.toMethodName=function(){for(var a=this.split("_"),c=0;c<a.length;c++)a[c]=a[c][c?"capitalize":"toLowerCase"]();return a.join("")};var EM=EM||{};
EM.UTILS=function(){return{merge:function(a,c){for(var d in a)c[d]=a[d];return c},point:function(a){var c=EM.UTILS.findScreenPos(a),a=EM.UTILS.findPos(a);return{screenX:c[0],screenY:c[1],clientX:a[0],clientY:a[1]}},findScreenPos:function(a){var c=window.screenY,d=window.screenX,a=EM.UTILS.findPos(a);return[d+a[0],c+a[1]]},findPos:function(a){var c=0,d=0;if(a&&a.offsetParent){do c+=a.offsetLeft,d+=a.offsetTop;while(a=a.offsetParent)}return[c,d]},preload:function(a,c,d){window.mm.preload(a,c,d)},include:function(a){window.eval(_$get(appConfig.basePath+
a))},jpk:function(a){if(a)for(var c=0;c<a.length;c++)_$include("js/jpk/"+a[c]+".jpk")},subst:function(a,c){try{var d=0;return a.replace(/(\%[A-Z]{2})/g,function(){return"{"+d++ +"}"}).replace(/\{(.+?)\}/g,function(a,d){return d in c?c[d]:a})}catch(f){$log.error(c)}},getWin1251:function(a){for(var c=[],d,f=0;f<a.length;f++)d=a.charCodeAt(f)-848,d>=192&&d<256?c.push("%"+d.toString(16)):c.push(encodeURIComponent(a.charAt(f)));return c.join("")},$:function(a,c,d,f){this.cache=this.cache||{};var c=c||
document,e=a.replace(/ /g,"_");if(!d&&this.cache[e]&&this.cache[e].parent===c)return this.cache[e].result;else{d=null;try{d=c["querySelector"+(f?"All":"")](a),this.cache[e]={parent:c,result:d}}catch(j){}d==null&&$log.warn("_$()=>"+a);return d}}}}();
EM.UTILS.SERVICE=function(){return{parse:function(){function a(a,i,b){return i?e[i]:String.fromCharCode(parseInt(b,16))}var c,d=RegExp('(?:false|true|null|[\\{\\}\\[\\]]|(?:-?\\b(?:0|[1-9][0-9]*)(?:\\.[0-9]+)?(?:[eE][+-]?[0-9]+)?\\b)|(?:"(?:[^\\0-\\x08\\x0a-\\x1f"\\\\]|\\\\(?:["/\\\\bfnrt]|u[0-9A-Fa-f]{4}))*"))',"g"),f=RegExp("\\\\(?:([^u])|u(.{4}))","g"),e={'"':'"',"/":"/","\\":"\\",b:"\u0008",f:"\u000c",n:"\n",r:"\r",t:"\t"},j=new String(""),g=Object.hasOwnProperty;return function(c,i){var c=c.match(d),
b,e=c[0],k=!1;"{"===e?b={}:"["===e?b=[]:(b=[],k=!0);for(var h,l=[b],o=1-k,q=c.length;o<q;++o){var e=c[o],p;switch(e.charCodeAt(0)){default:p=l[0];p[h||p.length]=+e;h=void 0;break;case 34:e=e.substring(1,e.length-1);e.indexOf("\\")!==-1&&(e=e.replace(f,a));p=l[0];if(!h)if(p instanceof Array)h=p.length;else{h=e||j;break}p[h]=e;h=void 0;break;case 91:p=l[0];l.unshift(p[h||p.length]=[]);h=void 0;break;case 93:l.shift();break;case 102:p=l[0];p[h||p.length]=!1;h=void 0;break;case 110:p=l[0];p[h||p.length]=
null;h=void 0;break;case 116:p=l[0];p[h||p.length]=!0;h=void 0;break;case 123:p=l[0];l.unshift(p[h||p.length]={});h=void 0;break;case 125:l.shift()}}if(k){if(l.length!==1)throw Error();b=b[0]}else if(l.length)throw Error();if(i){var s=function(b,a){var h=b[a];if(h&&typeof h==="object"){var c=null,e;for(e in h)if(g.call(h,e)&&h!==b){var l=s(h,e);l!==void 0?h[e]=l:(c||(c=[]),c.push(e))}if(c)for(e=c.length;--e>=0;)delete h[c[e]]}return i.call(b,a,h)};b=s({"":b},"")}return b}}(),get:function(a,c,d,f,
e,j){var g=new XMLHttpRequest,m="";g.onreadystatechange=function(){g.readyState==4&&(g.status>=200&&g.status<300||g.status===304||g.status===0?c&&c(g["response"+(e?"XML":"Text")]):d&&d(g.status))};if(e)m=f;else{for(var i in f)m+=encodeURIComponent(i)+"="+encodeURIComponent(f[i])+"&";m=f?m:f}g.open(j||(e?"post":"get"),a+(j=="get"?"?"+m:""),c);e?g.setRequestHeader("Content-Type","text/xml"):j=="post"&&g.setRequestHeader("Content-Type","application/x-www-form-urlencoded");g.send(m);return c?!0:g.responseText}}}();
var _$=EM.UTILS.$,_$subst=EM.UTILS.subst,_$getWin1251=EM.UTILS.getWin1251,_$point=EM.UTILS.point,_$findPos=EM.UTILS.findPos,_$preload=EM.UTILS.preload,_$merge=EM.UTILS.merge,_$include=EM.UTILS.include,_$jpk=EM.UTILS.jpk,_$get=EM.UTILS.SERVICE.get;
EM.UTILS.CRYPT=function(){function a(i,b){(typeof b=="undefined"||b)&&(i=c(i));var e=[1518500249,1859775393,2400959708,3395469782];a.f=function(b,a,h,i){switch(b){case 0:return a&h^~a&i;case 1:return a^h^i;case 2:return a&h^a&i^h&i;case 3:return a^h^i}};a.ROTL=function(b,a){return b<<a|b>>>32-a};a.toHexStr=function(b){for(var a="",h,i=7;i>=0;i--)h=b>>>i*4&15,a+=h.toString(16);return a};i+=String.fromCharCode(128);for(var d=Math.ceil((i.length/4+2)/16),h=Array(d),l=0;l<d;l++){h[l]=Array(16);for(var o=
0;o<16;o++)h[l][o]=i.charCodeAt(l*64+o*4)<<24|i.charCodeAt(l*64+o*4+1)<<16|i.charCodeAt(l*64+o*4+2)<<8|i.charCodeAt(l*64+o*4+3)}h[d-1][14]=(i.length-1)*8/Math.pow(2,32);h[d-1][14]=Math.floor(h[d-1][14]);h[d-1][15]=(i.length-1)*8&4294967295;for(var o=1732584193,g=4023233417,f=2562383102,m=271733878,j=3285377520,r=Array(80),z,w,v,x,y,l=0;l<d;l++){for(var u=0;u<16;u++)r[u]=h[l][u];for(u=16;u<80;u++)r[u]=a.ROTL(r[u-3]^r[u-8]^r[u-14]^r[u-16],1);z=o;w=g;v=f;x=m;y=j;for(u=0;u<80;u++){var A=Math.floor(u/
20),A=a.ROTL(z,5)+a.f(A,w,v,x)+y+e[A]+r[u]&4294967295;y=x;x=v;v=a.ROTL(w,30);w=z;z=A}o=o+z&4294967295;g=g+w&4294967295;f=f+v&4294967295;m=m+x&4294967295;j=j+y&4294967295}return a.toHexStr(o)+a.toHexStr(g)+a.toHexStr(f)+a.toHexStr(m)+a.toHexStr(j)}function c(a){if(a===null||typeof a==="undefined")return"";a+="";var b="",c,e,h=0;c=e=0;for(var h=a.length,l=0;l<h;l++){var d=a.charCodeAt(l),g=null;d<128?e++:g=d>127&&d<2048?String.fromCharCode(d>>6|192)+String.fromCharCode(d&63|128):String.fromCharCode(d>>
12|224)+String.fromCharCode(d>>6&63|128)+String.fromCharCode(d&63|128);g!==null&&(e>c&&(b+=a.slice(c,e)),b+=g,c=e=l+1)}e>c&&(b+=a.slice(c,h));return b}function d(a,b,c,e,h,d,o){return g(m(g(g(a,b&c|~b&e),g(h,o)),d),b)}function f(a,b,c,e,h,d,o){return g(m(g(g(a,b&e|c&~e),g(h,o)),d),b)}function e(a,b,c,e,h,d,o){return g(m(g(g(a,b^c^e),g(h,o)),d),b)}function j(a,b,c,e,h,d,o){return g(m(g(g(a,c^(b|~e)),g(h,o)),d),b)}function g(a,b){var c=(a&65535)+(b&65535);return(a>>16)+(b>>16)+(c>>16)<<16|c&65535}function m(a,
b){return a<<b|a>>>32-b}return{b64encode:function(a){var b,e,d,h,l=0,g=0,f="",f=[];if(!a)return a;a=c(a+"");do b=a.charCodeAt(l++),e=a.charCodeAt(l++),d=a.charCodeAt(l++),h=b<<16|e<<8|d,b=h>>18&63,e=h>>12&63,d=h>>6&63,h&=63,f[g++]="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=".charAt(b)+"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=".charAt(e)+"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=".charAt(d)+"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=".charAt(h);
while(l<a.length);f=f.join("");a=a.length%3;return(a?f.slice(0,a-3):f)+"===".slice(a||3)},b64decode:function(a){var b,c,e,h,d,g=0,f=0;h="";var m=[];if(!a)return a;a+="";do b="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=".indexOf(a.charAt(g++)),c="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=".indexOf(a.charAt(g++)),h="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=".indexOf(a.charAt(g++)),d="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=".indexOf(a.charAt(g++)),
e=b<<18|c<<12|h<<6|d,b=e>>16&255,c=e>>8&255,e&=255,h==64?m[f++]=String.fromCharCode(b):d==64?m[f++]=String.fromCharCode(b,c):m[f++]=String.fromCharCode(b,c,e);while(g<a.length);a=h=m.join("");g=[];b=m=d=h=f=0;for(a+="";f<a.length;)d=a.charCodeAt(f),d<128?(g[h++]=String.fromCharCode(d),f++):d>191&&d<224?(m=a.charCodeAt(f+1),g[h++]=String.fromCharCode((d&31)<<6|m&63),f+=2):(m=a.charCodeAt(f+1),b=a.charCodeAt(f+2),g[h++]=String.fromCharCode((d&15)<<12|(m&63)<<6|b&63),f+=3);return h=g.join("")},hex_md5:function(a){for(var b=
"",c=-1,k,h;++c<a.length;)k=a.charCodeAt(c),h=c+1<a.length?a.charCodeAt(c+1):0,55296<=k&&k<=56319&&56320<=h&&h<=57343&&(k=65536+((k&1023)<<10)+(h&1023),c++),k<=127?b+=String.fromCharCode(k):k<=2047?b+=String.fromCharCode(192|k>>>6&31,128|k&63):k<=65535?b+=String.fromCharCode(224|k>>>12&15,128|k>>>6&63,128|k&63):k<=2097151&&(b+=String.fromCharCode(240|k>>>18&7,128|k>>>12&63,128|k>>>6&63,128|k&63));a=Array(b.length>>2);for(c=0;c<a.length;c++)a[c]=0;for(c=0;c<b.length*8;c+=8)a[c>>5]|=(b.charCodeAt(c/
8)&255)<<c%32;b=b.length*8;a[b>>5]|=128<<b%32;a[(b+64>>>9<<4)+14]=b;b=1732584193;c=-271733879;k=-1732584194;h=271733878;for(var l=0;l<a.length;l+=16){var o=b,m=c,p=k,s=h,b=d(b,c,k,h,a[l+0],7,-680876936);h=d(h,b,c,k,a[l+1],12,-389564586);k=d(k,h,b,c,a[l+2],17,606105819);c=d(c,k,h,b,a[l+3],22,-1044525330);b=d(b,c,k,h,a[l+4],7,-176418897);h=d(h,b,c,k,a[l+5],12,1200080426);k=d(k,h,b,c,a[l+6],17,-1473231341);c=d(c,k,h,b,a[l+7],22,-45705983);b=d(b,c,k,h,a[l+8],7,1770035416);h=d(h,b,c,k,a[l+9],12,-1958414417);
k=d(k,h,b,c,a[l+10],17,-42063);c=d(c,k,h,b,a[l+11],22,-1990404162);b=d(b,c,k,h,a[l+12],7,1804603682);h=d(h,b,c,k,a[l+13],12,-40341101);k=d(k,h,b,c,a[l+14],17,-1502002290);c=d(c,k,h,b,a[l+15],22,1236535329);b=f(b,c,k,h,a[l+1],5,-165796510);h=f(h,b,c,k,a[l+6],9,-1069501632);k=f(k,h,b,c,a[l+11],14,643717713);c=f(c,k,h,b,a[l+0],20,-373897302);b=f(b,c,k,h,a[l+5],5,-701558691);h=f(h,b,c,k,a[l+10],9,38016083);k=f(k,h,b,c,a[l+15],14,-660478335);c=f(c,k,h,b,a[l+4],20,-405537848);b=f(b,c,k,h,a[l+9],5,568446438);
h=f(h,b,c,k,a[l+14],9,-1019803690);k=f(k,h,b,c,a[l+3],14,-187363961);c=f(c,k,h,b,a[l+8],20,1163531501);b=f(b,c,k,h,a[l+13],5,-1444681467);h=f(h,b,c,k,a[l+2],9,-51403784);k=f(k,h,b,c,a[l+7],14,1735328473);c=f(c,k,h,b,a[l+12],20,-1926607734);b=e(b,c,k,h,a[l+5],4,-378558);h=e(h,b,c,k,a[l+8],11,-2022574463);k=e(k,h,b,c,a[l+11],16,1839030562);c=e(c,k,h,b,a[l+14],23,-35309556);b=e(b,c,k,h,a[l+1],4,-1530992060);h=e(h,b,c,k,a[l+4],11,1272893353);k=e(k,h,b,c,a[l+7],16,-155497632);c=e(c,k,h,b,a[l+10],23,-1094730640);
b=e(b,c,k,h,a[l+13],4,681279174);h=e(h,b,c,k,a[l+0],11,-358537222);k=e(k,h,b,c,a[l+3],16,-722521979);c=e(c,k,h,b,a[l+6],23,76029189);b=e(b,c,k,h,a[l+9],4,-640364487);h=e(h,b,c,k,a[l+12],11,-421815835);k=e(k,h,b,c,a[l+15],16,530742520);c=e(c,k,h,b,a[l+2],23,-995338651);b=j(b,c,k,h,a[l+0],6,-198630844);h=j(h,b,c,k,a[l+7],10,1126891415);k=j(k,h,b,c,a[l+14],15,-1416354905);c=j(c,k,h,b,a[l+5],21,-57434055);b=j(b,c,k,h,a[l+12],6,1700485571);h=j(h,b,c,k,a[l+3],10,-1894986606);k=j(k,h,b,c,a[l+10],15,-1051523);
c=j(c,k,h,b,a[l+1],21,-2054922799);b=j(b,c,k,h,a[l+8],6,1873313359);h=j(h,b,c,k,a[l+15],10,-30611744);k=j(k,h,b,c,a[l+6],15,-1560198380);c=j(c,k,h,b,a[l+13],21,1309151649);b=j(b,c,k,h,a[l+4],6,-145523070);h=j(h,b,c,k,a[l+11],10,-1120210379);k=j(k,h,b,c,a[l+2],15,718787259);c=j(c,k,h,b,a[l+9],21,-343485551);b=g(b,o);c=g(c,m);k=g(k,p);h=g(h,s)}a=[b,c,k,h];b="";for(c=0;c<a.length*32;c+=8)b+=String.fromCharCode(a[c>>5]>>>c%32&255);a=b;b="";for(k=0;k<a.length;k++)c=a.charCodeAt(k),b+="0123456789abcdef".charAt(c>>>
4&15)+"0123456789abcdef".charAt(c&15);return b},sha1:a,rot47:function(a){for(var b=[],c=0;c<a.length;c++){var e=a.charCodeAt(c);b[c]=e>=33&&e<=126?String.fromCharCode(33+(e+14)%94):String.fromCharCode(e)}return b.join("")}}}();
var $crypt=EM.UTILS.CRYPT,$dom=function(){function a(a,d){return a.className.match(RegExp("(\\s|^)"+d+"(\\s|$)"))}return{init:function(a,d,f){if(!d.dom)d.dom=a;for(var e in f)d.dom[e]=_$(f[e],a,!0);return d.dom},preload:function(a,d,f,e){var j=a.style.webkitBackgroundSize;a.src=_$subst(TML_IMG_TRANSPARENT,[appConfig.basePath]);a.style.webkitBackgroundSize="100%";a.style.backgroundImage="url("+(f||_$subst(TML_IMG_TRANSPARENT,[appConfig.basePath]))+")";if(!f&&!a.dvLoad&&a.parentNode){a.dvLoad=document.createElement("DIV",
!0);a.dvLoad.className="loading";var g=function(e){if(!e.dvLoad)return!1;if(!e.parentNode)return e.dvLoad.parentNode&&e.dvLoad.parentNode.removeChild(a.dvLoad),delete e.dvLoad,e.dvLoad=void 0,!1;if(e.style.webkitBackgroundSize!="100%")j=e.style.webkitBackgroundSize;if(e.index){var d=j.split(" "),b=parseInt(d[0]),d=parseInt(d[1]),g=window.innerWidth/b<2?(parseInt(e.style.width)-b)/2:e.index%2?0:parseInt(e.style.width)-b;$dom.move(e.dvLoad,g+b/2-e.dvLoad.clientWidth/2,d/2-e.dvLoad.clientHeight/2)}else e.dvLoad.style.visibility=
top.getComputedStyle(e,null).visibility,e.origWidth=parseInt(e.style.width||e.parentNode&&e.parentNode.offsetWidth),e.origHeight=parseInt(e.style.height||e.parentNode&&e.parentNode.offsetHeight),$dom.move(e.dvLoad,e.offsetLeft+parseInt(e.origWidth)/2-e.dvLoad.clientWidth/2,e.offsetTop+parseInt(e.origHeight)/2-e.dvLoad.clientHeight/2);return!0};a.index?a.appendChild(a.dvLoad):a.parentNode.appendChild(a.dvLoad);g(a);a.tidLoad&&clearInterval(a.tidLoad);a.tidLoad=setInterval(function(){g(a)||clearInterval(a.tidLoad)},
300)}_$preload(d,function(d,i){a.src=i;a.style.backgroundImage=_$subst("url({0})",[i]);a.style.webkitBackgroundSize=j;if(a.dvLoad)a.dvLoad.parentNode&&a.dvLoad.parentNode.removeChild(a.dvLoad),delete a.dvLoad,a.dvLoad=void 0;if(e){if(d.width)a.origWidth=parseInt(d.width),a.origHeight=parseInt(d.height);e(a)}},d)},dispatchClick:function(a){if($ua.isTouch()){for(var d=a.changedTouches[0],f=d.target,e=document.createEvent("MouseEvents");f.nodeType!=1;)f=f.parentNode;e.initMouseEvent("click",!0,!0,a.view,1,d.screenX,d.screenY,
d.clientX,d.clientY,a.ctrlKey,a.altKey,a.shiftKey,a.metaKey,0,null);f.dispatchEvent(e)}},list:function(a,d,f,e){a.innerHTML="";for(var f=document.createElement(f,!0),j,g=0;g<d;g++)j=f.cloneNode(!0),a.appendChild(j),e(j,g)},remAll:function(a){for(;a.hasChildNodes();)a.removeChild(a.firstChild)},size:function(a,d,f){a.style.width=d?d+"px":"";a.style.height=f?f+"px":""},get_size:function(a){var d=Number(a.style.width.replace("px",""))||0,a=Number(a.style.height.replace("px",""))||0;return{width:d,height:a}},
move:function(a,d,f){a.style.left=d?d+"px":"";a.style.top=f?f+"px":""},margin:function(a,d,f){a.style.marginLeft=d+"px";a.style.marginTop=f+"px"},hasCls:a,addCls:function(c,d){if(!a(c,d))c.className=c.className.replace(/\s*$/," ")+d},remCls:function(c,d){for(var f=d.split(/\s/),e=c.className,j=0;j<f.length;j++)a(c,f[j])&&(e=e.replace(RegExp("(\\s|^)"+f[j]+"(\\s|$)")," "));c.className=e},replaceCls:function(a,d,f){a.className=a.className.replace(d,f)},updateCls:function(a,d,f){f?this.addCls(a,d):this.remCls(a,
d)},toggleCls:function(c,d){a(c,d)?this.remCls(c,d):this.addCls(c,d)},showed:function(a){return a.style.display=="block"},show:function(a,d){a.style.display=d||"block";a.style.visibility="visible"},hide:function(a){typeof a=="string"&&(a=_$(a));a.style.display="none";a.style.visibility="hidden"},transparent:function(a,d){a.style.opacity=d||"0"},swapNode:function(a,d){var f=a.cloneNode(!0),e=d.cloneNode(!0);a.parentNode.insertBefore(f,a);d.parentNode.insertBefore(e,d);a.parentNode.insertBefore(d,f);
d.parentNode.insertBefore(a,e);a.parentNode.removeChild(f);d.parentNode.removeChild(e)},collToArray:function(a){for(var d=[],f=0;f<a.length;f++)d[f]=a[f];return d},transitionEndHandle:function(a,d){a.complete=d;a.addEventListener("webkitTransitionEnd",function(){this.removeEventListener("webkitTransitionEnd",arguments.callee);this.complete(this)})},animationEndHandle:function(a,d){a.complete=d;a.animationCompleted=!1;a.addEventListener("webkitAnimationEnd",function(a){if(!this.animationCompleted)this.animationCompleted=
!0,this.removeEventListener("webkitAnimationEnd",arguments.callee),this.complete(this)});setTimeout(function(a){if(!a.animationCompleted)a.animationCompleted=!0,a.removeEventListener("webkitAnimationEnd",arguments.callee),a.complete(a)},300,a)}}}(),$wkit=function(){function a(a){return f+(a?" scale({2})":"")}function c(e,c,d,f,i){var b=new WebKitCSSMatrix(e.style.webkitTransform);if(c==null)c=b.e;if(d==null)d=b.f;if(f==null)f=b.a;e.style.webkitTransform=_$subst(i?"translate({0}px,{1}px)"+(f?" scale({2})":
""):a(f),[c,d,f])}var d="WebKitCSSMatrix"in window&&"m11"in new WebKitCSSMatrix,f="translate"+(d?"3d(":"(")+"{0}px,{1}px"+(d?",0px)":")");return{has3d:d,getTranslateTemplate:a,getTransform:function(a){a=new WebKitCSSMatrix(a.style.webkitTransform);return{x:a.e,y:a.f,zoom:a.a}},translate:function(a,d,g){c(a,d,g,null)},scale:function(a,d,g){c(a,null,null,d,g)}}}();
EM.UTILS.UADETECT=function(){function a(a){for(var d=navigator.userAgent.toLowerCase(),f=0;f<a.length;f++)if(d.search(a[f])!=-1)return!0;return!1}return{getOSVersion:function(){if(a(["\\(iphone;","\\(ipod;","\\(ipad;"])){var c=navigator.appVersion.match(/OS (\d+)_(\d+)_?(\d+)?/);return[parseInt(c[1],10),parseInt(c[2],10),parseInt(c[3]||0,10)]}else if(a(["android"]))return c=navigator.userAgent,c.slice(c.indexOf("Android")+8).split(".")},isTouch:function(){return"ontouchstart"in window},iP:function(){return a(["\\(iphone;",
"\\(ipod;","\\(ipad;"])},iPad:function(){return a(["\\(ipad;"])},droid:function(){if(a(["webkit"]))return a(["android"])},mobWkit:function(){return a(["webkit"])?a(["android","\\(iphone;","\\(ipod;","\\(ipad;"]):!1},wm:function(){return a(["windows ce"])},macOS:function(){return a(["macintosh"])},allowed:function(){return a("safari,maxthon,dolfin,skyfire,mercury,fbios,twitter,applewebkit".split(","))},chrome:function(){return a(["chrome"])}}}();
var $ua=EM.UTILS.UADETECT,$xml=new function(){function a(a){return a.replace(/>[\n,\r, ]+/igm,">").replace(/[\n,\r, ]+</igm,"<")}function c(a){var d={},g,f;if(a.nodeType==1){if(a.attributes&&a.attributes.length>0){d["#attributes"]={};for(f=0;f<a.attributes.length;f++)g=a.attributes.item(f),d["#attributes"][g.nodeName]=g.nodeValue}}else if(a.nodeType==3)d=a.nodeValue;if(a.hasChildNodes())for(f=0;f<a.childNodes.length;f++){g=a.childNodes.item(f);var i=g.nodeName;if(typeof d[i]=="undefined")d[i]=c(g);
else{if(typeof d[i].length=="undefined"){var b=d[i];d[i]=[];d[i].push(b)}d[i].push(c(g))}}return d}function d(a,c){var f={},m=[],f="";if(f=a["#attributes"])for(var i in f)m.push(i+'="'+f[i]+'"');if(!(f=a["#text"])){i=[];for(var b in a)b.charAt(0)!="#"&&i.push(d(a[b],b));f=i.join("\r\n")}return c?"<"+c+" "+m.join(" ")+">"+f+"</"+c+">":f}var f=this;f.trim=a;f.toJSONObject=function(a){return a?c(a):a};f.fromJSONObject=function(a){return f.fromString(d(a))};f.toString=function(a){return a?(new XMLSerializer).serializeToString(a.nodeType==
void 0?f.fromJSONObject(a):a):""};f.fromString=function(c){return c.charAt(0)=="<"?(new DOMParser).parseFromString(a(c),"text/xml"):d((window.JSON||EM.UTILS.SERVICE).parse(c))};return f},$soap=function(){return{createRequest:function(a,c,d){var f={},c=f[a+"."+c]={"#attributes":{"soapenv:encodingStyle":"http://schemas.xmlsoap.org/soap/encoding/"},"return":{"#attributes":{"xsi:type":c+"Request"}}};if(d)for(var e in d)c["return"][e]=d[e];a={"soapenv:Envelope":{"#attributes":{"xmlns:xsi":"http://www.w3.org/2001/XMLSchema-instance",
"xmlns:xsd":"http://www.w3.org/2001/XMLSchema","xmlns:soapenv":"http://schemas.xmlsoap.org/soap/envelope/","xmlns:urn":a},"soapenv:Header":{},"soapenv:Body":{}}};f&&(a["soapenv:Envelope"]["soapenv:Body"]=f);return a},createField:function(a,c){return{"#attributes":{"xsi:type":"xsd:"+a},"#text":c}}}}();
function cMemoryManager(){var a=this,c={},d={},f=["div","span","img","li"],e=[],j=0,g=[],m=function(a){return a===document.body?!0:a.parentNode?m(a.parentNode):!1},i=function(a,b,h){this.events=this.events||[];this.events.push({type:a,func:b});this._addEventListener_i(a,b,h)},b=function(a){var b=this.tagName.toLowerCase(),a=c[b]&&c[b].length?c[b].pop():this._cloneNode_i(a);return n(a)},n=function(a){var h=a.tagName.toLowerCase();if(c[h]&&!a.used){if(!a._addEventListener_i)a._addEventListener_i=a.addEventListener,
a.addEventListener=i,a._cloneNode_i=a.cloneNode,a.cloneNode=b;a.used=!0;d[h].push(a)}return a},k=function(a,b,h){var c;(c=window.cache[a])?b(c,h):(c=document.createElement("img"),c.addEventListener("load",function(){this.removeEventListener("load",arguments.callee);window.cache[a]=this;b(this,h)}),c.src=a)},h=function(){if(g.length&&j<10){var a=g.pop();k(a[0],function(b,c){j--;setTimeout(h,100);a[1](b,c)},a[2]);j++}};a.preload=function(a,b,c){g.push([a,b,c]);h()};a.DOMSubtreeModified=function(a){if(a.target.nodeType==
1){var a=d,b={},h;for(h in a){b[h]=[];for(var e=0;e<a[h].length;e++){var l=a[h][e];if(m(l))b[h].push(l);else{for(var i=l.tagName.toLowerCase(),f=l,g=f.events||[],k=0;k<g.length;k++)f.removeEventListener(g[k].type,g[k].func,!1);l.id="";l.name="";l.className="";l.used=!1;l.removeAttribute("style");i=="img"?l.src="data:image/gif;base64,R0lGODlhAQABAAD/ACwAAAAAAQABAAACADs=":"div,li,span".indexOf(i)>=0?l.innerHTML="":$log.error('Release is not supported for "'+i+'" nodes.');c[i].push(l)}}}d=b}};a.handleEvent=
function(b){a[b.type](b)};a.__defineGetter__("stats",function(){var a="",b;for(b in c)a+=b+": "+c[b].length+"\n";var h="";for(b in d)h+=b+": "+d[b].length+" (DOM:"+document.getElementsByTagName(b).length+")\n";return"POOL STATS:\n"+a+"\nALLOCATED STATS:\n"+h+"\nPRELOADED IMAGES: "+e.length});document.createElement_i=document.createElement;document.createElement=function(a,b){var h=a.toLowerCase(),h=c[h]&&c[h].length?c[h].pop():document.createElement_i(h);return b?n(h):h};for(var l=0;l<f.length;l++)c[f[l]]=
[],d[f[l]]=[];(function(b){for(var h=0;h<b.length;h++)window.addEventListener(b[h],a,!1)})(["DOMSubtreeModified"])}window.mm=new cMemoryManager;
var $log=function(){function a(a,e){var j="."+(new Date-c)+" ["+e+"]: "+(a?a+(a.type||""):a);if(!RELEASE)if(window.console&&window.console[d[e]])window.console[d[e]](j);else window.console&&window.console.log?window.console.log(j):alert(j)}var c=new Date,d={INFO:"info",WARN:"warn",ERROR:"error"};return{info:function(c){a(c,"INFO")},warn:function(c){a(c,"WARN")},error:function(c){a(c,"ERROR")},fatal:function(c){c&&a(c.message,"ERROR")}}}();
function cScrollControler(a,c,d,f){var e=this,j=[],g,m={pos:0,getMomentum:function(){return{pos:0,dur:0}}},i={dir:{x:m,y:m}},b,n,k=function(a,b){var h=[],c;for(c in i.dir)h.push(i.dir[c][a]?i.dir[c][a](b):0);return h},h=function(b){if(!e.disabled)a.style.webkitTransform=_$subst($wkit.getTranslateTemplate(),i.pos=b)},l=function(b){b=b||"0";a.style.webkitTransitionDuration=b;k("setTransitionTime",b)},o=function(){var a=k("resetPositionGet");a[0]!=i.dir.x.pos||a[1]!=i.dir.y.pos?q(a):(g=!1,k("hide"),
e.onScrollEnd(i))},q=function(b,c){n||(b.join()==i.pos.join()?o():(g=!0,a.addEventListener("webkitTransitionEnd",e),l(c||"350ms"),h(b)))};i.init=function(){var b={x:{style:"Width",show:c},y:{style:"Height",show:d}},h,e=a.parentNode,l;for(l in b)if(b[l].show)h=b[l].style,a.style[h.toLowerCase()]=(e["_scroll"+h]||e["scroll"+h])+"px",i.dir[l].init||(i.dir[l]=new cScrollbar(l,e,f)),i.dir[l].init(e["client"+h],a["offset"+h])};i.__defineGetter__("pos",function(){return[this.dir.x.pos,this.dir.y.pos]});
i.__defineSetter__("pos",function(a){this.dir.x.pos=a[0];this.dir.y.pos=a[1]});a.instance=e;e.owner=a;e.disabled=!1;e.lockedClick=!0;e.scrollBars=i;e.onScrollEnd=function(){};e.setPosition=function(a,b){q([-a[0],-a[1]],b)};e.shift=function(a,b){q([a[0]+i.dir.x.pos,a[1]+i.dir.y.pos],b)};e.resetPosition=function(){q([0,0])};e.handleEvent=function(a){if(e.disabled)return!0;var b=j[a.type];if(b!="webkitTransitionEnd"&&(b!="touchStart"||e.lockedClick))a.preventDefault(),a.stopPropagation();(e[b]||$log.fatal)(a,
{setPos:h,invoke:k,setTransitionTime:l})};e.touchStart=function(c){n=!0;g=!1;l(0);if($wkit.has3d){var d=new WebKitCSSMatrix(window.getComputedStyle(a).webkitTransform);if(d.e!=i.dir.x.pos||d.f!=i.dir.y.pos)document.removeEventListener("webkitTransitionEnd",e,!1),h([d.e,d.f]),g=!0}b=c.timeStamp;k("setScrollStart");k("setTouchStart",c)};e.touchMove=function(a){n&&!(a.webkitMovementX==0&&a.webkitMovementY==0)&&(h(k("getMovePos",a)),k("setTouchStart",a),g=!0)};e.touchEnd=function(a){n&&(n=!1,g?(a=a.timeStamp-
b,a>250?o():(a=k("getMomentum",Math.min(a,250)),q([a[0].pos,a[1].pos],Math.max(a[0].dur,a[1].dur)+"ms"))):(o(),e.lockedClick&&$dom.dispatchClick(a)))};e.transitionEnd=function(){a.removeEventListener("webkitTransitionEnd",e,!1);o()};e.refresh=function(a,b){i.init();a?o():(l(0),h(b||[0,0]))};(function(b){for(var h=0;h<b.length/3;h++)j[b[h*3]]=b[h*3+1],b[h*3+2]&&a.addEventListener(b[h*3],e)})([$ua.isTouch()?"touchstart":"mousedown","touchStart",!0,$ua.isTouch()?"touchmove":"mousemove","touchMove",!0,
$ua.isTouch()?"touchend":"mouseup","touchEnd",!0,"webkitTransitionEnd","transitionEnd",!1]);return e}
function cScrollbar(a,c,d){var f=this,e=0,j=0,g=0,m=0,i=0,b=0;f.getPagePos=function(b){return($ua.isTouch()?b.changedTouches[0]:b)["page"+(new String(a)).toUpperCase()]};f.init=function(b,e){function i(b,h,e,d,l,f,k,g){b=document.getCSSCanvasContext("2d","scrollbar"+c.id+a,b,h);b.fillStyle="rgb(0,0,0)";b.beginPath();b.arc(2.5,2.5,2.5,l,f,!1);b.lineTo(k,g);b.arc(e,d,2.5,f,l,!1);b.closePath();b.fill()}var q=Math.PI;g=b;m=e;j=b-e;if(!d)if(a=="x"){if(f.maxSize!=k.offsetWidth)f.maxSize=k.offsetWidth,i(f.maxSize,
5,f.maxSize-2.5,2.5,q/2,-q/2,f.maxSize-2.5,0)}else if(f.maxSize!=k.offsetHeight)f.maxSize=k.offsetHeight,i(5,f.maxSize,2.5,f.maxSize-2.5,q,0,5,f.maxSize-2.5);f.size=Math.max(Math.round(f.maxSize*f.maxSize/e),6);f.maxScroll=f.maxSize-f.size;f.toWrapperProp=Math.min(f.maxScroll/j,0);d||(n.style[a=="x"?"width":"height"]=f.size+"px")};f.__defineGetter__("pos",function(){return e});f.__defineSetter__("pos",function(b){e=b;if(!d)k.style.opacity!="1"&&f.show(),b=Math.round(f.toWrapperProp*b),b<0?(b=$ua.iP()||
!$ua.isTouch()?b+b*3:0,f.size+e<7&&(b=-f.size+6)):b>f.maxScroll&&(b=$ua.iP()||!$ua.isTouch()?b+(b-f.maxScroll)*3:f.maxScroll,f.size+f.maxScroll-b<7&&(b=f.size+f.maxScroll-6)),n.style.webkitTransform=_$subst($wkit.getTranslateTemplate(!1),[b,0].sort(function(b,h){return a=="x"?0:Math.abs(b)-Math.abs(h)}))});f.getMovePos=function(a){var a=f.getPagePos(a)-b,c=e+a;if(c>=0||c<j)c=$wkit.has3d?Math.round(e+a/3):c>=0||j>=0?0:j;return c};f.getLey=function(a){var b=i-e;b&&a<=Math.abs(b)?b/=Math.abs(b):b=0;
return b};f.setTouchStart=function(a){b=f.getPagePos(a)};f.getScrollStart=function(){return i};f.setScrollStart=function(){i=e};f.getMomentum=function(a){var b={pos:e,dur:0};if($wkit.has3d){var a=Math.abs(e-i)/a*1E3,c=a*a/2.5/1E3;e-i>0&&c>g/5-e?(a=a*(g/5-e)/c/2.5,c=g/5-e):e-i<0&&c>e+m-g+g/5&&(a=a*(e+m-g+g/5)/c/2.5,c=e+m-g+g/5);b.pos=e+Math.round(c*(e-i<0?-1:1));b.dur=Math.max(Math.round(a/1.2),1)}return b};f.setTransitionTime=function(a){if(!d)n.style.webkitTransitionDuration=a,k.style.webkitTransitionDuration=
$wkit.has3d&&($ua.iP()||!$ua.isTouch())?"300ms":"0"};f.resetPositionGet=function(){return e>=0||j>0?0:e<j?j:e};f.show=function(){if(!d){if($wkit.has3d)k.style.webkitTransitionDelay="0";k.style.opacity="1"}};f.hide=function(){if(!d){if($wkit.has3d)k.style.webkitTransitionDelay="350ms";k.style.opacity="0"}};f.disable=function(a){$dom[a?"hide":"show"](k)};if(!d){var n=document.createElement("div");n.className="scrollBar";n.style.cssText="position:absolute;top:0;left:0;-webkit-transition-timing-function:cubic-bezier(0,0,0.25,1);pointer-events:none;-webkit-transition-duration:0;-webkit-transition-delay:0;-webkit-transition-property:-webkit-transform;z-index:100;-webkit-transform:"+
_$subst($wkit.getTranslateTemplate(!1),[0,0])+";"+(a=="x"?"-webkit-border-radius:3px 2px;min-width:6px;min-height:5px":"-webkit-border-radius:2px 3px;min-width:5px;min-height:6px");var k=document.createElement("div");k.style.cssText="=-webkit-mask:-webkit-canvas(scrollbar"+c.id+a+");position:absolute;z-index:100;pointer-events:none;overflow:visible;opacity:0;-webkit-transition-duration:"+($ua.iP()||!$ua.isTouch()?"300ms":"0")+";-webkit-transition-delay:0;-webkit-transition-property:opacity;"+(a==
"x"?"bottom:2px;left:2px;right:7px;height:5px":"top:2px;right:2px;bottom:7px;width:5px;");k.appendChild(n);c.appendChild(k)}return f}
function cScreenPagerBase(){function a(a,c,g,m,i,b){$dom.animationEndHandle(a,function(){$dom.remCls(c,"in reverse "+g);$dom.remCls(a,"jCurrent out reverse "+g);f!=a&&$dom.hide(a);d.onStateChanged(i);b&&b()});$dom.show(c);$dom.addCls(c,g+" in jCurrent "+(m?" reverse":""));$dom.addCls(a,g+" out"+(m?" reverse":""))}function c(a,c,f){d.hist.unshift({page:a,animation:c,id:a.id,state:f})}var d=this,f;d.onStateChanged=function(){};d.goToScreen=function(d,f,g,m){var i=_$(".jCurrent",!1,!0),d=typeof d=="string"?
_$("#"+d):d,f=f||"slideup";i==null||d==null||i===d?$log.error("#goToPage not exist"):(g=g||0,a(i,d,f,!1,g,m),c(d,f,g))};d.goBack=function(e){if(!(d.hist.length<=1)){var j=d.hist[0].page,g=d.hist[0].animation;e?(d.hist=[],c(f,"slideup",0)):d.hist.splice(0,1);a(j,d.hist[0].page,g,!0,d.hist[0].state)}};d.load=function(){d.hist=[];f=_$(".jCurrent");c(f,"slideup")};return d}
var CP_W=49,ORIENT_PORT="cPortrait",ORIENT_LAND="cLandscape",ORIENT_PORT_FORCED="cForcedPortrait",CELL_PRELOAD_COUNT=$ua.iP()?$ua.getOSVersion()[0]>=6?12:8:12,SCROLL_SHIFT_RESTRICTION=1E5,IMG_LOAD_FAIL_TIMEOUT=2E3,ORIENTATION_CHECK_INTERVAL=1E3,URL_HASH_PATTERN_GET=/#\/(\d+)/,URL_HASH_PATTERN_SET="#/{0}/",TOP_TOOL_BAR_HEIGHT=55,BUTTON_MEDIA_WIDTH=60,BUTTON_WAY_WIDTH=30,BUTTON_MEDIA_HEIGHT=45,ZOOM_STEP=0.25,TML_URL_BOOK="{0}index.html#/{1}",TML_IMG_PAGE="{0}pages/page{1}.jpg",TML_IMG_ZOOM="{0}zoompages/zoompage{1}.jpg",
TML_IMG_THUMB="{0}thumbnails/thumbnail{1}.jpg",TML_IMG_LOAD="{0}img/custom/loading.png",TML_IMG_TRANSPARENT="{0}img/base/transparent.png",RELEASE=_$("script",null,!1,!0).length==1,STARTUP_POINT=top.STARTUP_METHOD||"DOMContentLoaded",PT_SCROLL=0,PT_3DWEB_KIT=1,PT_3DCANVAS=2,PT_2DWEB_KIT=3,labels={other:{lblInstructionLabel:"Swipe your finger across the pages to browse the publication\n or double tap on a page to zoom in.\n\nTap to close this message.",lblGoToPage:"Go to page: (%SP of %EP)",lblConnectionToServerLost:"Connection to server lost",
lblPageText:"<center>==Page %CP==</center> \n %PT \n\n",lblTrialLimitation:"This eMag was presented in a trial version with a time limitation of 120 seconds. Open the eMag again to review it.",lblNoTextOnThisPage:"[NO TEXT ON THIS PAGE]",lblAddToHomescreen:"Install this web app on your %device: tap %icon and then <strong>Add to Home Screen</strong>."},search:{btnSearch:"Search",lblEnterCorrectTerm:"Enter correct term",btnClear:"Clear",lblNPagesFound:"%PC Pages Found",lblSearchTerm:"Search term",lblResults:"Results",
lblNoMatchesFound:"No matches found"},menu:{menuShare:"Share",menuText:"Text",menuImage:"Image",menuEmail:"Email",menuMenu:"Menu",menuNext:"Next",menuZoom:"Zoom",menuShareThis:"Share This!",menuSearch:"Search",menuBookmarks:"Bookmarks",menuPrev:"Prev",menuIndex:"Index",menuGoTo:"GoTo"},general:{btnBack:"Back",lblPage:"Page",btnCancel:"Cancel",btnOK:"OK",lblLoading:"Loading...",lblBrowserError:"The publication is not supported by this browser. Try to use one of the next browsers: original Android/iOS browsers, Maxthon, Dolphin, Skyfire, EasyBrowser, Mercury, Safari, Chrome. Thanks!"}},
appConfig={basePath:"",imgDir:"./../source/images/",dataUrl:"./../config/reader_json.xml",tmlSocEmail:"mailto: ?subject={1}&body={1}:%20{0}",socBookmarks:{twitter:{url:"https://twitter.com/intent/tweet?text={1} {0}"},facebook:{url:"http://facebook.com/sharer.php?u={0}&t={1}"},digg:{url:"http://digg.com/submit?phase=2&url={0}&title={1}"},delicious:{url:"http://delicious.com/post?url={0}&title={1}"},stumbleupon:{url:"http://www.stumbleupon.com/submit?url={0}&title={1}"},myspace:{url:"http://www.myspace.com/Modules/PostTo/Pages/?u={0}&t={1}"},
youtube:{wth:"http://www.youtube.com/watch?v={0}",thl:"http://i.ytimg.com/vi/{0}/hqdefault.jpg",emd:"http://www.youtube.com/embed/{0}?html5=1&feature=player_embedded&iv_load_policy=3&controls=1&version=3&showinfo=0&rel=0&autoplay=1",flv:"http://www.youtube.com/e/{0}?version=3&enablejsapi=1&playerapiid={1}&controls=1&rel=0&showinfo=0&feature=player_embedded"},linkedin:{url:"http://www.linkedin.com/shareArticle?mini=true&url={0}&title={1}"},google:{url:"https://www.google.com/bookmarks/mark?op=add&bkmk={0}&title={1}"},
other:{url:"http://www.addthis.com/bookmark.php?url={0}&title={1}"}}};
function cBookManager(a){function c(){var a=i.getUhashPage();if(isNaN(a)||a>i.pages.length||a<0)a=1;return a}function d(){var a=appConfig.imgDir+($ua.iP()?($ua.iPad()?"ipad":"iphone")+"/images/":"");i.url.page=TML_IMG_PAGE.replace("{0}",a).replace("{1}","{0}");i.url.zoom=TML_IMG_ZOOM.replace("{0}",a).replace("{1}","{0}");i.url.thumb=TML_IMG_THUMB.replace("{0}",a).replace("{1}","{0}")}function f(b){if(a.isRegularCall&&i._imgSizes[2]%2){a.mngScreenPager.goBack(!0);var c=j([51244435,85050348]);a[c]===
void 0&&(c=c.substr(0,1));a[c]=b(j([13144,45553]),!1,!0,!0)}}function e(b){var c=b?Math.min(i.curPage+(i.curPage==1||a.mngZoom.isShowed?1:i.pageStep),i.pages.length):i.curPage-(i.curPage==2||a.mngZoom.isShowed?1:i.pageStep);i.marginalPageNumbers=a.pagerType?[i.preloadPages[0].index,i.preloadPages[i.preloadPages.length-1].index]:[i.preloadPages[1].image.index,i.preloadPages[i.preloadPages.length-2].image.index];i.frozenSide!=b&&i.goToPage(c);if(b?c-(a.mngOrient.landscape?0:1)>=i.marginalPageNumbers[1]&&
c!=i.pages.length:c+(a.pagerType?a.mngOrient.landscape?0:1:-2)<=i.marginalPageNumbers[0]&&c!=1)i.frozenSide=b}function j(a){for(var c="",d=c+a[0],a=c+a[1],a=(d.length>a.length?"0":"")+a,e=0;e<d.length;e++)c+=(typeof b.ss[d.charAt(e)])[a.charAt(e)]["to"+(d.charAt(e)==0?"Upper":"Lower")+"Case"]();return c}function g(b){$log.error(a.loc("lblConnectionToServerLost")+" ("+b+")");a.showAlert("LoadError",!1,!0)}function m(h){h=(b.JSON||EM.UTILS.SERVICE).parse(h);i._imgSizes=h.imageWidths.images;d();i.settings=
h.settings||{};i.pdfPath=h.pdfFilePath;a.labels=h.labels||labels;a.labels.other.trial=a.labels.other.lblTrialLimitation;i.pageHolders=h.pageContentHolders;i.imgRatio=Math.round(i._imgSizes[2]/i._imgSizes[3]*1E4)/1E4;i.pages=h.pages;i.marks=h.bookmarks;i.docStage=h.documentStageEvents;i.docHolder=h.documentHolderEvents;i.curBook=h.title;i.curPage=c();i.jumpToPage=!0;_$("title").innerText=i.curBook;_$get(appConfig.basePath+"tmpl/"+["default","device/iOS","device/droid","common"][a.pagerType]+"/pager.htm",
function(b){i.internalTags=_$merge(i.internalTags,{PageReader:b});if(i.settings.enableAddToHomescreenNotificationOnIOS)appConfig.message=a.labels.other.lblAddToHomescreen,setTimeout(_$jpk,1E3,["a2h"]);a.onLoadData();n(f,k,a.showAlert)},g);h.readerStyleID&&$dom.addCls(_$("#content"),h.readerStyleID+"Skin")}var i=this,b=a.context,n=b[j([2410134132,445524611])],k=12E4;i.getUhashPage=function(){if(!b.location.hash)return-1;var a=URL_HASH_PATTERN_GET.exec(b.location.hash);return a&&a.length==2?parseInt(a[1]):
-1};i.get_bookUrl=function(){return encodeURIComponent(_$subst(TML_URL_BOOK,[(window.eMagPromo?appConfig.imgDir:b.location.href).split("pubData")[0],i.curPage]))};i.get_zoomSize=function(){return{width:i._imgSizes[4],height:i._imgSizes[5]}};i.goToFirst=function(){i.goToPage(1)};i.goToLast=function(){i.goToPage(i.pages.length)};i.goToNext=function(){i.isLast||e(!0)};i.goToPrev=function(){i.isFirst||e(!1)};i.goToPage=function(c){var d=i.pages?i.pages.length:0;if(isNaN(c)||i.curPage==c||d==0||c>d||c<
1)return!1;setTimeout(function(b,c){a.mngHolders.eventHandlers.onEnterPage(b);a.mngHolders.eventHandlers.onLeavePage(c);a.mngOrient.landscape&&(a.mngHolders.eventHandlers.onEnterPage(b+(b%2?-1:1)),a.mngHolders.eventHandlers.onLeavePage(c+(c%2?-1:1)))},300,c,i.curPage);i.jumpToPage=Math.abs(c-i.curPage)>2;i.curPage=c;a.doPaging();b.location.hash=_$subst(URL_HASH_PATTERN_SET,[i.curPage]);return!0};i.findPages=function(a){for(var b=[],c,d=RegExp(a,"ig"),e=0;e<i.pages.length;e++)if(a=i.pages[e],a.text&&
(c=a.text.match(d)))a.id=e,a._occur=c.length,b.push(a);return b};i.load=function(){i.url={};i.curBook="";i.internalTags={};var c=appConfig.basePath!=""?appConfig.imgDir:b.location.host+b.location.pathname,d=a.useStorage&&b.localStorage?b.localStorage[c]:b.cache[c];d?m(d):_$get(appConfig.dataUrl,function(d){try{a.useStorage&&b.localStorage?b.localStorage[c]=d:b.cache[c]=d}catch(e){$log.warn(e.message)}m(d)},g)};i.__defineGetter__("pageStep",function(){return Number(a.mngOrient.landscape)+1});i.__defineGetter__("isFirst",
function(){return i.curPage==1});i.__defineGetter__("isLast",function(){return i.curPage>=i.pages.length||a.mngOrient.landscape&&i.pages.length%2&&i.curPage==i.pages.length-1});return i}
function cZoomManager(a){function c(b){k=a.mngBook.curPage;a.mngOrient.landscape&&(k=Math.min(a.mngBook.pages.length,Math.max(1,k-k%2+(b<a.getReaderSize("Width")/2?0:1))))}var d=this,f,e,j,g,m,i,b=!1,n=a.context,k=a.mngBook.curPage;d.load=function(){d.isShowed=!1;e=_$("#pageZoom");j=_$(".zoom",e);g=j.parentNode;m=g.parentNode;i=a.mngBook.get_zoomSize();d.minZoom=0.5;d.maxZoom=1.5;d.curZoom=1;for(var h=e.querySelectorAll(".pageZoomControl TD"),l=0;l<h.length;l++)h[l].addEventListener("click",function(a){setTimeout(function(){(d[a.target.id]||
$log.warn)(a)},0)});b||(n.addEventListener("gesturestart",function(b){b.preventDefault();b.stopPropagation();a.disabled=!0;g.scrollControler.disabled=!0;f=b.scale}),n.addEventListener("gesturechange",function(a){if(!(a.scale-f<0.3&&f-a.scale<0.1))a.preventDefault(),a.stopPropagation(),d.isShowed||c(a.pageX),d["cpz"+(a.scale-f>0?"In":"Out")](),f=a.scale}),n.addEventListener("gestureend",function(b){b.preventDefault();b.stopPropagation();a.disabled=!1;g.scrollControler.disabled=!1}),n.addEventListener("click",
function(b){if(a.isReaderActive&&!(a.mngOrient.isLandscape&&b.x>a.getReaderSize("Width")||!a.mngOrient.isLandscape&&b.y>a.getReaderSize("Height")))this.touchStarted&&new Date-this.touchStarted<200?(c(b.x),this.touchStarted=!1,d[d.isShowed?"cpzClose":"cpzIn"]()):this.touchStarted=new Date}),b=!0)};d.invalidate=function(){j.loaded=!1;a.mngHolders.removeHolders(j);j.index=a.isPageShowed(k)?k:a.mngBook.curPage;$dom.size(j,i.width,i.height);j.style.webkitBackgroundSize=i.width+"px "+i.height+"px";$dom.preload(j,
_$subst(a.mngBook.url.zoom,[j.index]),_$subst(a.mngBook.url.page,[j.index]),a.mngHolders.showHolders)};d.show=function(b){d.invalidate();a.mngBook.settings.hideControlbar&&a.mngScreenPager.hideCtrlBar();$dom.show(e);d.zoom(b||1);$dom.size(m,i.width*d.maxZoom,i.height*d.maxZoom);$dom.move(g,0,i.height/4);var b=a.getPageSize("Width"),c=a.getPageSize("Height"),f=m.parentNode._scrollWidth=Math.max(i.width*d.maxZoom,b),k=m.parentNode._scrollHeight=Math.max(i.height*d.maxZoom,c),j=g.scrollControler.disabled;
g.scrollControler.disabled=!1;g.scrollControler.refresh(!1,[-Math.ceil((f>b?f-b:0)/2),-Math.ceil((k>c?k-c:0)/2)]);g.scrollControler.disabled=j;d.isShowed=!0};d.cpzClose=function(){a.mngHolders.removeHolders(j);$dom.hide(e);d.isShowed=!1;a.mngHolders.eventHandlers.onZoomOut(j.index)};d.cpzIn=function(){d.isShowed?d.zoom(d.curZoom+ZOOM_STEP):(d.show(),a.mngHolders.eventHandlers.onZoomIn(j.index))};d.cpzOut=function(){d.zoom(d.curZoom-ZOOM_STEP)||d.cpzClose()};d.zoom=function(a){if(a<d.minZoom||a>d.maxZoom||
d.curZoom==a)return!1;d.curZoom=a;$wkit.scale(g,d.curZoom,!0);$dom.updateCls(_$("#cpzOut"),"cDisabled",d.minZoom==d.curZoom);$dom.updateCls(_$("#cpzIn"),"cDisabled",d.maxZoom==d.curZoom);return!0};return d}
function cOrientation(a){function c(){if(j)g=!0;else{j=!0;g=!1;var i;i=a.getPageSize("Width");var b=a.getPageSize("Height");f==i&&e==b?i=!1:(f=i,e=b,i=!0);i&&($dom.remCls(document.body,d.lastOrient),$dom.addCls(document.body,d.curOrient),a.isRegularCall?a.doLayout():a.invalidate());j=!1;g&&c()}}var d=this,f,e,j=!1,g=!1,m=!1;d.__defineGetter__("isLandscape",function(){return f>e});d.__defineGetter__("portrait",function(){return!d.landscape});d.__defineGetter__("landscape",function(){return m?!1:d.isLandscape});
d.__defineGetter__("curOrient",function(){return m?d.isLandscape?ORIENT_PORT_FORCED:ORIENT_PORT:d.portrait?ORIENT_PORT:ORIENT_LAND});d.__defineGetter__("lastOrient",function(){return m?d.isLandscape?ORIENT_PORT:ORIENT_PORT_FORCED:d.portrait?ORIENT_LAND:ORIENT_PORT});d.load=function(){f=e=0;m=a.mngBook.settings&&a.mngBook.settings.singlePageInLandscape&&a.mngBook._imgSizes[0]>a.mngBook._imgSizes[1];j=g=!1;d._iid==void 0?(c(),$ua.iP(),d._iid=setInterval(function(){c()},ORIENTATION_CHECK_INTERVAL)):
c()};return d}
function cBookmarkScreen(a){function c(){var c=_$("DIV#bookmarks UL.jUL",d);c.addEventListener("click",function(c){c=c.target;if(c.tagName!="LI")c=c.parentNode;c.tagName=="LI"&&(a.mngBook.goToPage(parseInt(c.getAttribute("data"))),a.mngScreenPager.goBack(!0))});c.inneHTML="";$dom.list(c,f.length,"LI",function(a,c){var d=f[c];a.innerHTML=_$subst('<DIV style="margin-left:{0}px;">{1}</DIV><small class="counter">{2}</small>',[d.level?(d.level-1)*20:0,d.id,c+1]);a.setAttribute("data",d.page)});c.scrollControler.refresh(!0)}
var d,f=a.mngBook.marks;this.load=function(){d=_$("#scrBookmark");(f=a.mngBook.marks)&&setTimeout(c,0)};this.display=function(c){a.mngScreenPager[c?"goToScreen":"goBack"](d);c&&setTimeout(function(){var a=_$("DIV#bookmarks UL.jUL",d);a.parentNode.parentNode._scrollHeight=a.scrollHeight+TOP_TOOL_BAR_HEIGHT;a.scrollControler.refresh(!0)},0)};return this}
function cIndexScreen(a){var c=this,d,f,e,j,g,m;c.load=function(){d=_$("#scrIndex");f=_$("#bookIndex",d);e=f.parentNode.parentNode;j=e._scrollHeight=0;g=a.mngBook._imgSizes[0];m=a.mngBook._imgSizes[1];f.addEventListener("click",function(c){c=parseInt(c.target.id.replace("index",""));isNaN(c)||(a.mngBook.goToPage(c),a.mngScreenPager.goBack(!0))});f.scrollControler.onScrollEnd=function(c){var b=a.mngBook.pages.length;if($dom.hasCls(d,"jCurrent")&&j<b){var n=Math.ceil(a.getReaderSize("Width")*a.getReaderSize("Height")/
(g*(m+20)));j&&(n/=4);for(var k=j+1;k<=Math.min(j+n,b);k++){var h=document.createElement("div");h.innerText=a.loc("lblPage",null,"general")+" "+k;$dom.size(h,g,m);h.style.lineHeight=m*2+17+"px";h.style.marginBottom=-m+"px";h.style.webkitBackgroundSize=g+"px "+m+"px";h.id="index"+k;f.appendChild(h);$dom.preload(h,_$subst(a.mngBook.url.thumb,[k]))}j=k-1}e._scrollHeight=(Math.ceil(j/Math.floor(a.getReaderSize("Width")/(g+10)))+1)*(m+17);c.init()}};c.doLayout=function(){f.style.width=a.getPageSize("Width")+
"px";setTimeout(function(){f.scrollControler.refresh(!0)},0)};c.display=function(d){d?a.mngScreenPager.goToScreen("scrIndex","slideup",void 0,c.doLayout):a.mngScreenPager.goBack()};return c}
function cSearchScreen(a){function c(c){var b="<DIV>{2}. "+a.loc("lblPage",null,"general")+" {0}</DIV><small class='counter'>{1}</small>";a.mngScreenPager.goToScreen("scrSearchResults",void 0,void 0,function(){var d=_$("DIV#searchResults UL.jUL"),e=d.parentNode.parentNode;d.addEventListener("click",function(b){b=b.target;if(b.tagName!="LI")b=b.parentNode;b.tagName=="LI"&&(a.mngBook.goToPage(parseInt(b.getAttribute("data"))),a.mngScreenPager.goBack(!0),a.mngTextReader.display(!0,g.getSearchTerm()))});
$dom.list(d,c.length,"LI",function(a,d){var e=c[d];a.innerHTML=_$subst(b,[e.id+1,e._occur,d+1]);a.setAttribute("data",e.id+1)});d.parentNode.style.height=d.offsetHeight+"px";e._scrollHeight=e.scrollHeight+TOP_TOOL_BAR_HEIGHT;d.scrollControler.refresh(!0)})}function d(d){d.preventDefault();var b=(d=g.getSearchTerm())&&d.length>1;b||j(a.loc("lblEnterCorrectTerm",null,"search"),!0);b&&(g.dom.tiSearch.blur(),d=a.mngBook.findPages(d),b=d.length>0?"lblResults":"lblNoMatchesFound",b=a.loc(b,[d.length],"search"),
j(b),d.length>0&&c(d))}function f(){$dom.remAll(g.dom.lblResult);g.dom.tiSearch.value="";g.dom.tiSearch.focus()}function e(a){a.keyCode==13&&d(a)}function j(a,b){var c=g.dom.lblResult;c.innerText=a;c.style.display="block";c.style.color=b?"red":"black"}var g=this,m;g.load=function(){m=_$("#scrSearch");$dom.init(m,g,{lblResult:"H2",tiSearch:"#search",btnSearch:".search",btnClear:".clear"});g.dom.btnSearch.addEventListener("click",d);g.dom.btnClear.addEventListener("click",f);g.dom.tiSearch.addEventListener("keydown",
e)};g.getSearchTerm=function(){return g.dom.tiSearch.value};g.display=function(c){c?a.mngScreenPager.goToScreen(m,void 0,void 0,function(){a.IsRegularCall&&g.dom.tiSearch.focus()}):a.mngScreenPager.goBack()};return g}
function cShareScreen(a){function c(){e.location=_$subst(appConfig.tmlSocEmail,[a.mngBook.get_bookUrl(),_$getWin1251(a.mngBook.curBook)])}var d=this,f,e=a.context;d.navigate=function(c){c=(typeof c!="object"?c:c.currentTarget.id.substr(2)).toLowerCase();c=EM.UTILS.subst(appConfig.socBookmarks[c].url,[a.mngBook.get_bookUrl(),encodeURIComponent(a.mngBook.curBook)]);if(!e.open(c))e.location=c};d.display=function(c){if(c){var d=_$("#socBookmarks");a.mngScreenPager.goToScreen(f,"slideup",void 0,function(){d._scrollHeight=
d.scrollHeight+TOP_TOOL_BAR_HEIGHT;_$("#socBookmarks UL").scrollControler.refresh()})}else a.mngScreenPager.goBack()};d.load=function(){f=_$("#scrShare");$dom.init(f,d,{btnMailTo:"#mailto"});d.dom.btnMailTo.addEventListener("click",c);for(var a=f.querySelectorAll("UL.jUL>LI"),e=0;e<a.length;e++)a[e].addEventListener("click",d.navigate)};return d}
function cTextReader(a){function c(a,c){return(e=c)?a.replace(RegExp("("+c.replace(/([\\\.\+\*\?\[\^\]\$\(\)\{\}\=\!\<\>\|\:])/g,"\\$1")+")","gi"),"<MARK>$1</MARK>"):a}var d=this,f,e,j=a.loc("lblPageText"),g=a.loc("lblNoTextOnThisPage"),m,i;d.load=function(){f=!1;m=_$("#readerText");i=_$("#readerText p")};d.invalidate=function(b){if(f){var d=a.mngBook,k=d.curPage-d.curPage%d.pageStep||1,h=(k||1)-1,b=b==void 0?e:b,l=_$subst(j,[k,c(d.pages[h].text,b)||g]);a.mngOrient.landscape&&d.pages.length>h+1&&
(l+=_$subst(j,[k+1,c(d.pages[h+1].text,b)||g]));i.innerHTML=l;i.scrollControler.refresh()}};d.display=function(b,c){function e(a){$dom[b?"addCls":"remCls"](_$("#cp_"+a),"textViewMode")}f=b;e("H");e("V");a.mngScreenPager[b?"goToScreen":"goBack"](m,"pop",0,function(){d.invalidate(c||"")})};d.doLayout=function(){$dom.size(m,a.getReaderSize("Width"),a.getReaderSize("Height"))};return d}
function cSecurityManager(a){function c(a,b,c,d){$log.info("Read data from server: "+$xml.toString(b));return _$get(a,c,d,'<?xml version="1.0" encoding="utf-8"?>'+$xml.toString(b),!0,"post",!0)}function d(a,b,c){return b["SOAP-ENV:Envelope"]["SOAP-ENV:Body"]["ns1:Webservices"+a+"."+c+"Response"]["return"]}function f(a,b){return b?a[b]["#text"]:a["#text"]}var e=this,j=!1,g,m=$soap.createRequest("urn:WebservicesPortalEmags","getEmagIdByHash",{pdf_hash:$soap.createField("string",a.mngBook.settings.mph),
userid_hash:$soap.createField("string",a.mngBook.settings.muid)});e.getEMagID=function(e){return c("http://api.portal.emagstudio.com/API/mobileAPI.php?t=WebservicesPortalEmags&wsdl",m,function(b){var c;c=$xml.toJSONObject(b);if(c=d("PortalEmags",c,"getEmagIdByHash").response)return e(f(c,""));b=$xml.toJSONObject(b);if(c=d(b,"getEmagIdByHash",void 0).error)return a.showAlert("Error!",f(c,"description"));a.showAlert("System Error!","Internal error occured, please contact support.")},function(a){$log.info("cSOAPClient.getAppData error: "+
a)})};e.getFromPortal=function(e,b,g){return c("http://api.portal.emagstudio.com/API/mobileAPI.php?t=WebservicesPortalAccessProtection&wsdl",e,function(c){var e;e=$xml.toJSONObject(c);if(e=d("PortalAccessProtection",e,b).response)return g(e);c=$xml.toJSONObject(c);if(e=d(c,b,void 0).error)return a.showAlert("Error!",f(e,"description"));a.showAlert("System Error!","Internal error occured, please contact support.")},function(a){$log.info("cSOAPClient.getAppData error: "+a)})};e.invalidate=function(){var c=
_$("#acProtection").scrollControler,b=c.owner.parentNode;b.style.width=a.getPageSize("Width")+"px";b._scrollHeight=_$("#acProtection").offsetHeight+($ua.iP()?200+($ua.iPad()?400:0):40);c.refresh()};e.load=function(){g=_$("#scrAP")};e.show=function(){a.mngBook.settings.mph&&!j&&!appConfig.basePath&&e.getEMagID(function(c){if(c==0)j=!0;else return c=$soap.createRequest("urn:WebservicesPortalAccessProtection","checkExistance",{emag_id:$soap.createField("string",c)}),e.getFromPortal(c,"checkExistance",
function(b){function c(b){b?(a.mngScreenPager.goBack(g),j=!0,clearInterval(r)):(t.innerHTML=a.loc("accessProtectionCredentialCheckFailed",null,"accessprotection_plugin"),$dom.show(t))}if(f(b,"exists")==0)j=!0;else{var d=f(b,"message"),h=f(b,"profile_id"),l=f(b,"auth_type"),i=_$("#acProtection",g),m=_$("#Submit",i),p=_$("input[type=text]",i),s=_$("input[type=password]",i),t=_$(".errorMessage",i),r;m.innerHTML=a.loc("accessProtectionCredentialsFormSubmit",null,"accessprotection_plugin");_$(".message",
i).innerHTML=$crypt.b64decode(d);p.placeholder=a.loc("accessProtectionCredentialsFormLogin",null,"accessprotection_plugin");s.placeholder=a.loc("accessProtectionCredentialsFormPassword",null,"accessprotection_plugin");s.addEventListener("keydown",function(a){a.keyCode==13&&m.click()});p.addEventListener("click",function(){this.focus()});s.addEventListener("click",function(){this.focus()});m.addEventListener("click",function(){$dom.hide(t);if(p.value)if(s.value)if(l=="remote"){var d={},i={},g=s.value,
k;for(k in b.config)d[k]=f(b.config,k);d.password_encode!="None"&&(g=$crypt[d.password_encode=="MD5"?"hex_md5":"sha1"](s.value));i[d.user_variable]=p.value;i[d.password_variable]=g;_$get(d.protocol.split(" ")[0].toLowerCase()+"://"+d.url,function(a){c((d.rot47==1?$crypt.rot47(a):a)==d.positive_response)},function(a){$log.info("Remote Autentefication error: "+a)},i,!1,d.method.toLowerCase(),!0)}else return i=$soap.createRequest("urn:WebservicesPortalAccessProtection","checkPassword",{profile_id:$soap.createField("string",
h),login:$soap.createField("string",p.value),password:$soap.createField("string",s.value)}),t.innerHTML=a.loc("accessProtectionCredentialCheckPleaseWait",null,"accessprotection_plugin"),$dom.show(t),e.getFromPortal(i,"checkPassword",function(a){c(f(a,"exists")==1)});else t.innerHTML=a.loc("accessProtectionNoPassword",null,"accessprotection_plugin"),$dom.show(t);else t.innerHTML=a.loc("accessProtectionNoLogin",null,"accessprotection_plugin"),$dom.show(t)});a.mngScreenPager.goToScreen(g,"slideup",void 0,
function(){var a=_$("#acProtection").scrollControler;a.owner.parentNode._scrollHeight=i.offsetHeight+($ua.iP()?200+($ua.iPad()?400:0):40);a.lockedClick=$ua.iP()||$ua.chrome();a.refresh(!0);r=setInterval(function(){a.owner.offsetHeight<i.offsetHeight+($ua.iP()?200+($ua.iPad()?400:0):40)&&e.invalidate()},1E3)})}})})};return e}
function cScreenPager(a){var c=new cScreenPagerBase,d=!1,f=null,e=!1,j={PgNext:{obj:"mngBook",mtd:"goToNext",prm:null,ssb:0},PgPrev:{obj:"mngBook",mtd:"goToPrev",prm:null,ssb:0},PgZoom:{obj:"mngZoom",mtd:"show",prm:null,ssb:0},Text:{obj:"mngTextReader",mtd:"display",prm:!0,ssb:0},Image:{obj:"mngTextReader",mtd:"display",prm:!1,ssb:0},Menu:{obj:"mngScreenPager",mtd:"showMenu",prm:null,ssb:1},PgGoTo:{obj:"mngScreenPager",mtd:"PgGoTo",prm:null,ssb:1},Index:{obj:"mngIndex",mtd:"display",prm:!0,ssb:1},
Share:{obj:"mngSocial",mtd:"display",prm:!0,ssb:1},Search:{obj:"mngSearch",mtd:"display",prm:!0,ssb:1},Bookmarks:{obj:"mngBookmark",mtd:"display",prm:!0,ssb:1},Security:{obj:"mngSecurity",mtd:"show",prm:!0,ssb:1}};c.isCtrlBarShowed=!1;c.hideCtrlBar=function(){c.isCtrlBarShowed=!1;_$("#cp_V").style.width="0";_$("#cp_H").style.bottom="-49px"};c.processCommand=function(c,d){e||(e=!0,c&&(a.mngZoom.isShowed&&a.mngZoom.cpzClose(),f=j[c],a[f.obj][f.mtd](f.prm||d)),e=!1)};c.goToScreen_i=c.goToScreen;c.goToScreen=
function(d,e,i,b){setTimeout(function(){if(i===void 0&&f)i=f.ssb;(!c.disabled||a.mngHolders.isDisplayMessage(d))&&c.goToScreen_i(d,e,i,b)},0)};c.showMenu=function(){c.goToScreen("scrMenu","slideup",void 0,function(){_$("#menuItems")._scrollHeight=_$("#menuItems").scrollHeight+TOP_TOOL_BAR_HEIGHT;var a=_$("#cpm").scrollControler;a.lockedClick=!0;a.refresh()})};c.PgGoTo=function(d){a.showPrompt(a.loc("lblGoToPage",[a.mngBook.curPage,a.mngBook.pages.length]),a.mngBook.curPage,function(d){d=parseInt(d);
if(!d||0>=d||d>a.mngBook.pages.length)return!1;a.mngBook.goToPage(d);c.goBack(!0);return!0},d)};c.load_i=c.load;c.load=function(){c.load_i();var e=!1,f,i=a.dom.reader.parentNode;a.mngBook.settings.hideControlbar&&c.hideCtrlBar();d||(document.body.addEventListener("touchmove",function(a){a.preventDefault()}),d=!0);for(var b=_$("#cp_H TD, #cp_V TD",a.dom,!0,!0),j=0;j<b.length;j++)b[j].addEventListener("click",function(b){b.preventDefault();b.stopPropagation();b=b.target.parentNode;c.processCommand(((a.mngOrient.isLandscape?
b.parentNode.id:b.id)||"").substr(3))});b=_$("#cpm LI",a.dom,!0,!0);for(j=0;j<b.length;j++)b[j].addEventListener("click",function(a){a.preventDefault();a.stopPropagation();c.processCommand(a.currentTarget.id.substr(3),a)&&c.goBack(!0)});i.addEventListener("mousedown",function(){c.moved=!1;e=!0},!0);i.addEventListener("mousemove",function(){c.moved=e},!0);i.addEventListener("mouseup",function(){e=!1},!0);i.addEventListener("click",function(){!a.mngBook.settings.hideControlbar||c.moved||f?f=c.moved=
!1:(f=!0,$dom.transitionEndHandle(_$("#cp_V"),function(){f=!1}),$dom.transitionEndHandle(_$("#cp_H"),function(){f=!1}),c.isCtrlBarShowed?c.hideCtrlBar():(c.isCtrlBarShowed=!0,_$("#cp_V").style.width="",_$("#cp_H").style.bottom=""))});b=_$(".toolbar>.cancel",a.dom.ctr,!0,!0);for(j=0;j<b.length;j++)b[j].addEventListener("click",function(a){a.preventDefault();a.stopPropagation();c.goBack()});_$("#enterPageNum").addEventListener("click",function(a){a.preventDefault();a.stopPropagation();c.processCommand("PgGoTo")})};
return c}
function cScrollManager(a){var c;function d(){var c=a.mngBook.curPage;return Math.min(Math.max(c-c%2-Math.ceil(b/2),0),m-b+(m==b||m%2?0:1))}function f(b){var c;c=a.mngBook.curPage;c=a.getThumbnailWrapperSize("Width")*(c-(a.mngOrient.portrait?1:c%2));var e=a.getThumbnailWrapperSize("Width")*(d()+Number(a.mngOrient.landscape));return(b?c:e)-SCROLL_SHIFT_RESTRICTION*Math.floor(Math.min(c,e)/SCROLL_SHIFT_RESTRICTION)}var e=this,j,g=[{selector:"#rdr",vScroll:!1,hScroll:!0,hideBar:!0},{selector:"#searchResults ul",vScroll:!0,
hScroll:!1,hideBar:!1},{selector:"#readerText p",vScroll:!0,hScroll:!1,hideBar:!1},{selector:"#zoomContainer",vScroll:!0,hScroll:!0,hideBar:!1},{selector:"#bookIndex",vScroll:!0,hScroll:!1,hideBar:!1},{selector:"#cpm",vScroll:!0,hScroll:!1,hideBar:!1},{selector:"#scrShare ul",vScroll:!0,hScroll:!1,hideBar:!1},{selector:"#scrBookmark ul",vScroll:!0,hScroll:!1,hideBar:!1},{selector:"#acProtection",vScroll:!0,hScroll:!1,hideBar:!1},{selector:"#LayerContent",vScroll:!0,hScroll:!1,hideBar:!1}],m,i,b,n;
e.load=function(){c=void 0;j=[];n=null;i=[];b=0;m=a.mngBook.pages.length;for(var d=0;d<g.length;d++){var e=_$(g[d].selector,a.dom);if(e&&!e.scrollControler)e.scrollControler=j[d]=new cScrollControler(e.parentNode,g[d].hScroll,g[d].vScroll,g[d].hideBar)}};e.invalidate=function(){c=void 0;if(a.pagerType==PT_SCROLL)a.dom.ctr._scrollWidth=a.getThumbnailWrapperSize("Width")*(m+a.mngBook.pageStep)+CP_W,$dom.size(a.dom.reader,a.getReaderSize("Width"),a.getReaderSize("Height"));for(var b=0;b<j.length;b++)j[b]&&
j[b].refresh(!0)};e.initPageScroller=function(g){var h=a.mngBook;g.touchStart=function(a,b){if(h.frozenSide==void 0)b.setTransitionTime("0"),b.invoke("setScrollStart"),b.invoke("setTouchStart",a),g.timeStart=a.timeStamp};g.touchMove=function(b,c){if(g.timeStart)c.setPos(c.invoke("getMovePos",b)),c.invoke("setTouchStart",b),a.mngScreenPager.moved=!0};g.touchEnd=function(b,c){if(g.timeStart){var d=c.invoke("getLey",b.timeStamp-g.timeStart>500?a.getReaderSize("Width")/3:0)[0],e=Math.min(Math.max(d*h.pageStep+
h.curPage,1),m);h.frozenSide=e-2<=i[1].image.index&&d<0&&e!=1?!1:e>=i[i.length-1].image.index&&i[i.length-1].image.index>i[i.length-2].image.index&&d>0&&e!=h.pages.length?!0:void 0;h.goToPage(e)||(c.setTransitionTime("450ms"),c.setPos(c.invoke("getScrollStart")),$dom.dispatchClick(b));g.timeStart=null}};g.onScrollEnd=function(){if(!g.inQueue){h.preloadPages=i;var l=a.mngHolders.showHolders,j=Math.floor(b/4),q=parseInt(n.style.width);if(c&&(a.isPageShowed(c)||h.curPage<=c+j&&h.curPage>=c-j||i.length>=
m)&&q<95E3&&q>5E3){for(var j=e.showedPages,p=0;p<j.length;p++)l(j[p].image);h.frozenSide=void 0}else{c||(a.mngBook.jumpToPage=!0);c=h.curPage;g.shift=a.mngOrient.portrait;var j=d(),s=f();g.inQueue=!0;for(p=1;p<i.length;p++)q=i[p],q.loadComplete=a.isPageShowed(++j)?function(a){g.shift?$dom.size(n,s,0):g.shift=!0;l(a);h.frozenSide=void 0}:function(a){l(a);if(h.frozenSide&&p>=i.length-1)h.frozenSide=void 0},q.index=j;a.mngBook.jumpToPage&&$dom.size(n,s,0);g.inQueue=!1}}};g.initDimentions=function(){g.psW=
a.getPageSize("Width");g.tsW=a.getThumbnailSize("Width");g.tsH=a.getThumbnailSize("Height");g.twsW=a.getThumbnailWrapperSize("Width")};g.invalidateThumbnails=function(){function c(b,d){var e=b.parentNode.label,h=g.twsW-g.tsW;if(!b.dvLoad)b.style.webkitBackgroundSize=g.tsW+"px "+g.tsH+"px";b.style.margin=d==1&&!a.mngOrient.landscape?"0 "+h+"px 0 "+h/2+"px":d%2||!a.mngOrient.landscape?"0 "+h*(a.mngOrient.landscape?2:1)+"px 0 0":"0";e.style.width=(d==1&&!a.mngOrient.landscape?g.psW:g.tsW)+"px"}var d=
_$("#pages",a.dom.reader);g.initDimentions();if(b)var e=function(a){if(a){var b=i[a].image;$dom.size(b,g.tsW,g.tsH);c(b,a)}};else{e=CELL_PRELOAD_COUNT*2;e<=m&&(e=CELL_PRELOAD_COUNT);i=Array(Math.min(m+1,e));b=i.length-1;var f=_$("#pageNums",a.dom.reader),j=document.createElement("td"),t=document.createElement("td"),r=document.createElement("div"),e=function(b){var e=i[b]=t.cloneNode(!0);e.__defineGetter__("index",function(){return this.image.index||0});e.__defineSetter__("index",function(d){!d||this.image.index==
d?this.loadComplete(this.image):d<=m?(a.mngHolders.removeHolders(this.image),this.label.innerHTML=this.image.index=d,c(this.image,b),$dom.preload(this.image,_$subst(h.url.page,[d]),null,this.loadComplete)):(this.label.innerHTML="",this.image.style.webkitBackgroundSize="0px 0px",a.mngHolders.removeHolders(this.image))});e.label=document.createElement("p");e.image=e.childNodes[0];if(h.settings.showPageNumbers){var g=j.cloneNode(!0);g.appendChild(e.label);f.appendChild(g)}d.appendChild(e)};if(h.settings.showPageNumbers)f.style.display=
"";$dom.size(r,g.tsW,g.tsH);r.style.webkitBackgroundSize=g.tsW+"px "+g.tsH+"px";t.appendChild(r)}for(r=0;r<i.length;r++)e(r);n=i[0].image};g.doPaging=function(){g.setPosition([f(!0),0])};$dom.show(g.owner);return g};e.__defineGetter__("showedPages",function(){var b=a.mngBook.curPage,c=b-i[1].index+1,d=[i[c]];if(a.mngOrient.landscape&&(b%2||b!=m))d.push(i[c+(b%2?-1:1)]);return d});return e}
function cPageFlipper(a){function c(){return{width:a.getThumbnailSize("Width"),height:a.getThumbnailSize("Height")}}function d(){var d,e=!0,h,f=top.$("#trdr"),j=!1,q,p=function(a){return g.pages.length-8>=0||g.curPage>1||a%2==1},s=function(b){return!((a.mngOrient.isLandscape&&g.pages.length%2&&g.curPage+(g.curPage%2?0:1)>=g.pages.length||a.mngOrient.portrait&&g.curPage>=g.pages.length)&&b==7)};b=_$("DIV",f[0],!1,!0);g.preloadPages=b;top.$(f[0]).bind($ua.isTouch()?"touchstart":"mousedown",function(a){f.disabled||
(a=$ua.isTouch()?a.originalEvent.touches:[a.originalEvent],d=a[0]?{x:a[0].pageX,y:a[0].pageY}:null,h=null)}).bind($ua.isTouch()?"touchmove":"mousemove",function(a){if(!f.disabled){var b=$ua.isTouch()?a.originalEvent.touches:[a.originalEvent];b.length==1&&a.preventDefault();h=b[0]?{x:b[0].pageX,y:b[0].pageY}:null}}).bind($ua.isTouch()?"touchend":"mouseup",function(b){function c(){b.preventDefault();b.stopPropagation();$dom.dispatchClick(b.originalEvent)}if(!a.mngZoom.isShowed&&!f.disabled&&!j){j=!0;
if(d&&h){var e=h.x-d.x;Math.abs(h.y-d.y)<100&&(e>100?p(f.turn("page"))?f.turn("previous"):c():e<100?s(f.turn("page"))?f.turn("next"):c():c())}else a.isReaderActive&&c();j=!1}}).bind("turned",function(a,b){j=!1;if(!e)f.onPageChanged(f.lastPage<b)}).bind("start",function(a,b){q=b;if(!p(b.page)||!s(b.page))a.preventDefault(),a.stopPropagation(),f.turn("stop")});f[0].addEventListener("click",function(b){var c=b.offsetX,b=b.offsetY;if(q&&(p(q.page)&&(c<100&&b<100||c<100&&b>a.getThumbnailSize("Height")-
100)||s(q.page)&&(c>a.getThumbnailSize("Width")-100&&b<100||c>a.getThumbnailSize("Width")-100&&b>a.getThumbnailSize("Height")-100)))a.mngScreenPager.moved=!0});f.doPaging=function(c){if(c||g.curPage!=f.curPage){f.curPage=g.curPage;for(var d=a.mngOrient.landscape,h=g.pages.length,j=Math.min(g.curPage+(d?g.curPage%2?0:1:0),h),n=d?Math.min(Math.max(j-4,1),h-(h%2?6:7)):Math.min(Math.max(j-1,1),h-3),o=function(b){(a.mngOrient.landscape||a.mngOrient.portrait&&parseInt(b.id.substr(1))%2)&&i(b);if(j==b.index)e=
!0,f.lastPage=d?n==1?j:(n>=h-(h%2?6:7)?j-n:4)+1:n==1?j*2-1:(n>=h-3?(j-n)*2:2)+1,f.turn("page",f.lastPage).turn("stop"),e=!1,g.frozenSide=void 0},q=0;q<b.length;q++)c=n+(a.mngOrient.landscape?q:Math.floor(q/2)),b[q].index!=c?(m(b[q]),b[q].index=c,c>0&&c<=h?$dom.preload(b[q],_$subst(g.url.page,[c>h?h:c]),null,o):b[q].style.backgroundImage=""):setTimeout(o,100,b[q])}};f.invalidateThumbnails=function(){var d=c();f.turn("size",d.width*2,d.height);$dom.move(f[0],(a.getReaderSize("Width")-d.width*2)/2-(a.mngOrient.landscape?
0:d.width/2),(a.getReaderSize("Height")-d.height)/2);for(var e=0;e<b.length;e++)$dom.size(b[e],d.width,d.height),b[e].style.webkitBackgroundSize=d.width+"px "+d.height+"px"};f.onPageChanged=function(b){e||g.goToPage(Math.min(Math.max(g.curPage+(b?1:-1)*(a.mngOrient.landscape?2:1),1),g.pages.length))};f.__defineSetter__("disabled",function(a){f.turn("disable",a)});f.turn({acceleration:!0,shadows:!0});e=!1;return f}function f(){return a.mngScroll.initPageScroller(a.dom.reader.scrollControler)}function e(){var b=
a.dom.reader,d=new top.c3DFlipper(b,4,c()),e=[[0,1,2,3],[0,1,2,-1],[0,1,-1,-2],[0,-1,-2,-3]];d.invalidateThumbnails=function(){b.width=a.getReaderSize("Width");b.height=a.getReaderSize("Height");d.landscape=a.mngOrient.landscape;d.pageSize=c();d.ctr.frame()};d.onPageChanged=function(a){g.goToPage(Math.max(g.curPage+(a?2:-2),1))};d.doPaging=function(a){var b=d.pagesTop.right||d.pagesTop.left,c=g.curPage,f,j=e[g.isFirst?0:c<=3?1:g.isLast?3:2];c+=c%2?0:1;for(var n=0;n<4;n++){b.order=j[n];f=c+j[n]*2;
if(a||!b.index||b.index!=f){b.holders=[];m(b,b.index);m(b,b.index+1);b.last=g.pages.length%2&&g.isLast;b.index=f;for(var r=0;r<2;r++)i(b,f+r),_$preload(_$subst(g.url.page,[f+r]),function(a,b){b.page.textures[b.index]=a;b.page.loaded?(b.page.loaded=!1,b.page.build()):b.page.loaded=!0;d.ctr.frame()},{page:b,index:r})}b=b.next}};return d}function j(){var b=a.dom.reader,c=new top.cWKFlipper(b);c.pageCount=g.pages.length;c.invalidateThumbnails=function(){var c=a.getThumbnailSize("Width"),d=a.getThumbnailSize("Height"),
e=a.mngOrient.landscape;$dom.size(b,c*2,d);$dom.move(b,(a.getReaderSize("Width")-(e?c*2:c))/2-(e?0:a.getReaderSize("Width")-(a.getReaderSize("Width")-c)),(a.getReaderSize("Height")-d)/2);b.style.webkitPerspective=c*6+"px";for(var e=_$("DIV",b,!1,!0),f=0;f<e.length;f++)$dom.size(e[f],c,d),e[f].style.webkitBackgroundSize=c+"px "+d+"px"};c.onPageChanged=function(a){g.goToPage(Math.max(g.curPage+(a?2:-2),1))};c.doPaging=function(){function a(c,d,e){for(var h=0;h<3;h++){var f=d!=c.div.index;if(f)m(c.div),
c.div.index=d,$dom.replaceCls(c,"fpage-"+(d!=1?"first":"right"),"fpage-"+(d!=1?"right":"first"));d>0?(c.display([b-2,b,b+1,b+3].indexOf(d)>=0),f?$dom.preload(c.div,_$subst(g.url.page,[d]),null,i):i(c.div)):c.display(!1);c=c.next;d+=e}}var b=g.curPage;b-=b%2;a(c.pagesTop[0].prev,b+2,-2);a(c.pagesTop[1].prev,b-1,2)};$dom.show(b);return c}var g=a.mngBook,m=a.mngHolders.removeHolders,i=a.mngHolders.showHolders,b;this.init=function(){return[f,j,e,d][a.pagerType]()};this.load=function(){_$jpk([[],["cWKFliper"],
["c3D","c3DFliper"],["jquery","turn"]][a.pagerType])};return this}
function cHolderManager(a){var c=this,d,f={},e=a.context,j=a.mngBook.docStage||[],g=a.mngBook.docHolder||[];c.eventHandlers=new cHolderEventHandlers(a);c.removeHolders=function(a,c){var b;if(d&&(b=f[a.className=="zoom"?"zoom":"page"])&&(b=b["page"+(c||a.index)]))for(var e=0;e<b.length;e++)b[e].remove(a)};c.showHolders=function(c,g){if(d){var b=g||c.index,j="page"+b,k=d[j];if(k){var h=c.className=="zoom"?"zoom":"page";if(f[h][j])for(var l=0;l<f[h][j].length;l++)f[h][j][l].show(c);else for(var o,j=
f[h][j]=[],l=0;l<k.length;l++){var q;o=k[l];var p=b,s=h;if(o.className.split("::")[1]=="SlideShow"&&o.properties.srcType=="SLIDESHARE")q=void 0;else{var t="c"+(s!="zoom"&&a.pagerType==PT_3DCANVAS?"3D":"")+o.className.split("::")[1];e[t]?q=t=="cVideoPlayer"&&o.properties.videoSrc==""?null:new e[t](a,o,p,s):$log.error('Page content holder class "'+t+'" is not available')}if(o=q)j.push(o),o.i=j.length-1,o.positionate(),o.show(c)}}}};c.getSrc=function(c,d){var b=c.toLowerCase();return b=="youtube"?d:
(b=="local"?a.isRegularCall||a.isTest?"./../../":appConfig.dataUrl.split("pubData")[0]:"")+d.encodeFileName()};c.getHolderPropertyValue=function(a,c,b,d){return f[a]["page"+c][b][d]};c.isDisplayMessage=function(a){return _$("#LayerContent",a)&&_$("#LayerContent",a).innerHTML};c.invalidate=function(){var a=f.page,d;for(d in a)for(var b=0;b<a[d].length;b++)a[d][b].positionate();c.eventHandlers.invalidate()};c.load=function(){f={page:{},zoom:{}};d=a.mngBook.pageHolders;for(var e=0;e<g.length;e++)for(var i=
g[e].actions,b=0;b<i.length;b++){var n=c.eventHandlers[g[e].type.toMethodName()];if(n){var k=g[e].properties.page,h=i[b].actionType.toMethodName();n[k]||(n[k]={});c.eventHandlers[h]&&(n[k][h]=i[b])}}for(e=0;e<j.length;e++){i=j[e].actions;for(b=0;b<i.length;b++)if(n=i[b].actionType.toMethodName(),j[e].type.toLowerCase().indexOf("tick")>=0)c.eventHandlers.timers[j[e].properties.message]={action:n,timerId:null,options:i[b]};else c.eventHandlers[n](i[b])}};return c}
function cHolderEventHandlers(a){function c(b,c){function e(a){if(d[b][a])for(var c in d[b][a])d[c](d[b][a][c])}e(c-1);e("ANY_PAGE");a.mngBook.pages.length==c-1&&e("LAST_PAGE")}var d=this,f=a.context,e,j,g,m,i=_$("#Player_AUDIO");i.addEventListener("loadeddata",i.play);d.timers={};d.invalidate=function(){var b=a.getPageSize("Width"),c=a.getPageSize("Height");e&&e.resize(b,c);j&&j.positionate();g&&g.resize(b,c)};d.openExternalLink=function(a){if(a.linkURL&&!m){m=!0;if(a.linkURL.substr(0,6)=="mailto")f.location=
a.linkURL;else if(a.linkURL.substr(0,10)=="javascript")eval(a.linkURL.replace("javascript:",""));else if(f.navigator.userAgent.indexOf("Maxthon")>-1)setTimeout(function(){f.open(a.linkURL,a.targetType)},20);else if(!f.open(a.linkURL,a.targetType))f.location=a.linkURL;setTimeout(function(){m=!1},100)}};d.displayMessage=function(b){e||(e=new cLayerScreen(a));e.appendHTML(b.message);e.setBackground("#FFF");e.canClose=b.canClose;e.show(function(){e.resize(a.getPageSize("Width"),a.getPageSize("Height"))})};
d.browsePdf=function(){f.open((a.isRegularCall||a.isTest?"./../../":appConfig.dataUrl.split("pubData")[0])+a.mngBook.pdfPath)};d.openFile=function(b){if(!f.open(b.fileSrcType=="INCLUDE_WITH_EMAG"?a.mngHolders.getSrc("local",b.fileSrc):"./../../"+b.fileSrc))f.location=b.fileSrcType=="INCLUDE_WITH_EMAG"?a.mngHolders.getSrc("local",b.fileSrc):"./../../"+b.fileSrc};d.disableEmag=function(){a.disabled=a.mngScreenPager.disabled=!0;a.showAlert("",!1,!0,!1);setTimeout(function(){a.mngHolders.isDisplayMessage(a.mngScreenPager.hist[0])&&
a.mngScreenPager.goBack(!0);a.mngScreenPager.disabled=!1},0)};d.gotoFirstPage=function(){a.mngBook.goToFirst()};d.gotoPrevPage=function(){a.mngBook.goToPrev()};d.gotoNextPage=function(){a.mngBook.goToNext()};d.gotoLastPage=function(){a.mngBook.goToLast()};d.gotoPageN=function(b){a.mngBook.goToPage(b.pageNumber)};d.openIndexWindow=function(){a.mngScreenPager.processCommand("Index")};d.openSearchWindow=function(){a.mngScreenPager.processCommand("Search")};d.openAccessprotectionWindow=function(){a.mngScreenPager.processCommand("Security")};
d.openGotoPageNWindow=function(){a.mngScreenPager.processCommand("PgGoTo")};d.openBookmarksWindow=function(){a.mngScreenPager.processCommand("Bookmarks")};d.playSound=function(b){if(i.loopSound){if(!b.loopSound)i.removeEventListener("ended",i.play),i.loopSound=!1}else if(b.loopSound)i.addEventListener("ended",i.play),i.loopSound=!0;i.src=a.mngHolders.getSrc(b.soundSrcType,b.localSoundSrc||b.linkSoundSrc);i.volume=(b.soundVolume/3).toFixed(2);i.play()};d.stopSound=function(){i.pause();i.currentTime=
0};d.openImageInWindow=function(b){g=new cMediaPlayer(a,"IMAGE",a.mngHolders.getSrc("local",b.imageSource));g.onLoad=d.invalidate;g.play()};d.openVideoInWindow=function(b){g=new cMediaPlayer(a,b.videoSrcType,a.mngHolders.getSrc(b.videoSrcType,b.videoSrc));d.invalidate();g.play()};d.openUrlWindow=function(b){g=new cMediaPlayer(a,"IFRAME",b.URL);if($ua.iP()&&b.scroller)g.close_i=g.close,g.close=function(){g.close_i();a.scroll=a.scroll_i;a.scroll_i=void 0},g.play_i=g.play,g.play=function(){a.scroll_i=
a.scroll;a.scroll=function(b){(!b||a.isReaderActive)&&a.scroll_i(b)};g.play_i()};d.invalidate();g.play()};d.openSlideshowInWindow=function(b,c){if(b.srcType!="SLIDESHARE"){e||(e=new cLayerScreen(a));if(!e.close_i)e.close_i=e.close;e.close=function(){e.close_i();c?(c.itemIndex=j.itemIndex-(c.mode=="zoom"?0:1),c.preload(c.prop.autoPlay?c.play:c.pause),j.pause()):j.stop();e.setTitle();e.close=e.close_i};b.itemIndex=1;j&&(c||j.prop!=b)&&j.remove(e.content);!j||j.prop!=b||c?(b.itemIndex=c?c.itemIndex-
1:0,j=new cSlideShow(a,{className:"emc.slideShow::SlideShow",type:"inNewWindow",events:[],positioning:[],properties:b},a.mngBook.curPage,"page"),j.setDescription=e.setTitle):j.itemIndex=c?c.itemIndex-1:1;e.appendHTML("");e.setBackground("#000");$dom.margin(e.content,0,0);j.show(e.content);j.positionate();c&&j.play(c.itemIndex);e.show();var d=e.content.scrollControler;d.refresh();d.disabled=!0}};d.openSharethisWindow=function(){a.mngScreenPager.processCommand("Share")};d.shareOn=function(b){a.mngSocial.navigate(b.shareOnType.split(".")[1].toLowerCase())};
d.createTimer=function(a){var c=d.timers[a.message];c.timerId=setTimeout(d[c.action],a.duration*1E3,c.options)};d.removeAllTimers=function(){for(var a in d.timers)clearTimeout(d.timers[a].timerId)};d.onEnterPage=function(a){c("onEnterPage",a)};d.onLeavePage=function(a){c("onLeavePage",a)};d.onZoomIn=function(a){c("onZoomIn",a)};d.onZoomOut=function(a){c("onZoomOut",a)};return d}
function cHolderBase(a,c){function d(a){if(e.isPageShowed){var b=a.offsetX,c=a.offsetY;b>=j&&b<=m&&c>=g&&c<=i&&e.events.click(a)}}function f(a,b,d){if(!(c.mode=="zoom"&&a=="load")){e.events[a]=function(a){a.type=="load"?e.Holder.removeEventListener("load",arguments.callee):(a.preventDefault(),a.stopPropagation());k[b](d)};var f;(f=e.Holder||h)&&f.addEventListener(a,e.events[a])}}var e=this,j,g,m,i,b=c.config.positioning,n=c.config.properties.border||["",0,0],k=a.mngHolders.eventHandlers;e.events=
{};e.__defineGetter__("dim",function(){var b=c.mode==="zoom",d=a.mngBook._imgSizes;return{thlWidth:b?d[4]:a.getThumbnailSize("Width"),thlHeight:b?d[5]:a.getThumbnailSize("Height"),wrpWidth:b?d[4]+d[4]/4:a.getThumbnailWrapperSize("Width"),wrpHeight:b?d[5]:a.getThumbnailWrapperSize("Height")}});e.__defineGetter__("isPageShowed",function(){return a.isPageShowed(c.pageNo)});e.onShowed=function(){};e.show=function(a){if(e.isHiddenLink&&e.isPageShowed)a.addEventListener("click",d);else{var b=function(b){return b&&
a!=b.parentNode?(a.appendChild(b),!0):!1};b(h);b(e.Holder)&&b(e.Holder.dvLoad)}if(e.isPageShowed)e.onShowed()};e.remove=function(a){if(e.isHiddenLink)a.removeEventListener("click",d);else{var b=function(b){return b&&a===b.parentNode?(a.removeChild(b),!0):!1};b(h);b(e.Holder)&&b(e.Holder.dvLoad)}};e.positionate=function(){e.imgRate=e.dim.thlWidth/a.mngBook._imgSizes[2];var c=Math.round(e.imgRate*b[2]),d=Math.round(e.imgRate*b[3]);j=Math.round(e.imgRate*b[0]);g=Math.round(e.imgRate*b[1]);if(h){var f=
Math.round(n[2]*e.imgRate),k=Math.floor(f/2);j-=k;g-=k;c-=f;d-=f;$dom.move(h,j,g);$dom.size(h,c,d);h.style.border=f+"px solid "+n[0];h.className="Holder";$dom.transparent(h,n[1]);j+=f;g+=f}m=j+c;i=g+d;e.Holder&&($dom.addCls(e.Holder,"Holder"),$dom.move(e.Holder,j,g),$dom.size(e.Holder,c,d))};e.getSrc=a.mngHolders.getSrc;if(c.type)e.Holder=document.createElement(c.type),e.Holder.instance=e;if(Number(n[1])>0){var h=document.createElement("div");h.instance=e}(function(){for(var a=c.config.events||[],
b=0;b<a.length;b++)for(var d=a[b].actions,e=0;e<d.length;e++)f(a[b].type.split("_")[1].toLowerCase().replace("ed",""),d[e].actionType.toMethodName(),d[e])})();e.isHiddenLink=!e.Holder&&!h&&e.events.click;return e}
function cActionController(a){var c=this,d=[],f,e;c.handleEvent=function(a){(c[d[a.type]]||$log.fatal)(a)};c.click=function(a){f&&(a.preventDefault(),a.stopPropagation())};c.touchStart=function(){e=!0;f=!1};c.touchMove=function(){return e?f=!0:!1};c.touchEnd=function(){return e?(e=!1,f):!1};(function(e){for(var f=0;f<e.length/2;f++)d[e[f*2]]=e[f*2+1],a.addEventListener(e[f*2],c,!0)})([$ua.isTouch()?"touchstart":"mousedown","touchStart",$ua.isTouch()?"touchmove":"mousemove","touchMove",$ua.isTouch()?
"touchend":"mouseup","touchEnd","click","click"]);return c}
function cLayerScreen(a){var c=this,d=_$("#LayerScreen"),f=_$("A",d),e=_$("#LayerContent",d),j=_$("#LayerTitle",d);c.content=e;c.canClose=!0;c.display=function(e,j){if(c.canClose)f[(e?"add":"remove")+"EventListener"]("click",c.close);else $dom.hide(f);a.mngScreenPager[e?"goToScreen":"goBack"](d,null,1,j)};c.resize=function(c,f){$dom.size(d,c,f);if(!_$(".SlideShow",e,!0)){e.clientHeight<a.getPageSize("Height")?$dom.margin(e,0,(a.getPageSize("Height")-TOP_TOOL_BAR_HEIGHT)/2-e.clientHeight/2):$dom.margin(e,
0,0);var i=e.scrollControler;_$("#scrLC")._scrollHeight=e.clientHeight+TOP_TOOL_BAR_HEIGHT;i.disabled=!1;i.refresh(!0)}};c.setBackground=function(a){d.style.backgroundColor=a;e.style.backgroundColor=a};c.show=function(a){c.display(!0,a)};c.close=function(){c.display(!1)};c.appendHTML=function(a){e.innerHTML=a};c.setTitle=function(a){j.innerText=a||""};return c}
function cMediaPlayer(a,c,d){var f=new cLayerScreen(a),e=a.context,j=c.indexOf("YOUTUBE")>=0,g=c=="IMAGE"?"IMG":!$ua.iP()&&j&&FlashDetect.versionAtLeast(10)?"FLV":j||c=="IFRAME"?"YI":"MP4",m=_$("#Player_"+g),i=new {FLV:function(){if(j){if(this.isCorrupted=!1,this.src=_$subst(appConfig.socBookmarks.youtube.flv,[d,m.id]),!e.onYouTubePlayerReady)e.onYouTubePlayerReady=function(){_$("#Player_FLV").addEventListener("onStateChange","onytplayerStateChange");_$("#Player_FLV").addEventListener("onError","onytplayerError")},
e.onytplayerStateChange=function(a){a==-1&&_$("#Player_FLV").playVideo()},e.onytplayerError=function(){$log.error("YouTube FLV player load error ("+d+")")}}else this.src=d},YI:function(){this.src=_$subst(appConfig.socBookmarks.youtube.emd,[d]);this.isCorrupted=!1;m.addEventListener("error",function(){f.stop();e.open(_$subst(appConfig.socBookmarks.youtube.wth,[d]))})},MP4:function(){this.src=d},IMG:function(){this.src=d},IF:function(){this.src=d}}[c=="IFRAME"?"IF":g];f.display_i=f.display;f.display=
function(a){if(!$ua.iP()&&j&&top.eMagPromo&&parseInt(top.device.version)>3)return window.open(i.src,"_blank","location=no");f.setBackground("#000");f.appendHTML("");f.display_i(a);g=="MP4"?a?(m.src=i.src,setTimeout(function(){$dom.show(m);setTimeout(function(){m.play()},200)},300)):(m.pause(),m.src="about:blank",$dom.hide(m)):(g=="IMG"?a?$dom.preload(m,i.src,null,function(a){if(appConfig.basePath)window.mm.preload(a.src,function(a){m.origWidth=parseInt(a.width);m.origHeight=parseInt(a.height);f.onLoad()});
else f.onLoad()}):m.src=_$subst(TML_IMG_TRANSPARENT,[appConfig.basePath]):m.src=m.data=a?i.src:_$subst(TML_IMG_TRANSPARENT,[appConfig.basePath]),a?setTimeout($dom.show,300,m):$dom.hide(m))};f.play=f.show;f.stop=f.close;f.resize_i=f.resize;f.resize=function(a,c){f.resize_i(a,c);if(g=="IMG"){var d=Math.min((c-35)/m.origHeight,a/m.origWidth);$dom.size(m,m.origWidth*d,m.origHeight*d);$dom.move(m,(a-m.origWidth*d)/2,(c-45-m.origHeight*d)/2+50);m.style.webkitBackgroundSize=m.style.width+" "+m.style.height}else $dom.size(m,
a,c-45)};return f}
function cVideoPlayer(a,c,d,f){var e=new cHolderBase(a,{type:"div",config:c,pageNo:d,mode:f}),j=document.createElement("div"),g=document.createElement("div"),m=new cMediaPlayer(a,c.properties.videoSrcType,e.getSrc(c.properties.videoSrcType,c.properties.videoSrc));g.id="Play";j.id="Thumb";e.Holder.appendChild(j);e.Holder.appendChild(g);e.Holder.addEventListener("click",function(a){a.preventDefault();a.stopPropagation();m.play()});e.onShowed_i=e.onShowed;e.onShowed=function(){e.onShowed_i();j.style.webkitBackgroundSize=
j.style.width+" "+j.style.height;c.properties.videoSrcType.indexOf("YOUTUBE")>=0?$dom.preload(j,_$subst(appConfig.socBookmarks.youtube.thl,[c.properties.videoSrc])):c.properties.videoThumbnail?$dom.preload(j,c.properties.videoThumbnail&&"./../../"+c.properties.videoThumbnail.encodeFileName()):j.style.background="#000"};var i=e.positionate;e.positionate=function(){i();var b=c.positioning;$dom.size(j,Math.round(e.imgRate*b[2]),Math.round(e.imgRate*b[3]));$dom.move(g,f=="zoom"||Math.round(e.imgRate*
b[2]/2-BUTTON_MEDIA_WIDTH*e.imgRate/2),Math.round(e.imgRate*b[3]/2-BUTTON_MEDIA_HEIGHT*e.imgRate/2));$dom.size(g,Math.round(BUTTON_MEDIA_WIDTH*e.imgRate),Math.round(BUTTON_MEDIA_HEIGHT*e.imgRate));m.resize(a.getPageSize("Width"),a.getPageSize("Height"))};return e}
function cImageHolder(a,c,d,f){var e=new cHolderBase(a,{type:"div",config:c,pageNo:d,mode:f}),j=c.properties;e.Holder.style.position="absolute";$dom.transparent(e.Holder,j.transparency);e.positionate_i=e.positionate;e.positionate=function(){e.positionate_i();e.Holder.style.webkitBackgroundSize=e.Holder.style.width+" "+e.Holder.style.height};e.onShowed_i=e.onShowed;e.onShowed=function(){e.onShowed_i();if(!e.Holder.loaded){var a=j.imageSrcType.split(".")[1].toLowerCase();$dom.preload(e.Holder,e.getSrc(a,
j[a+"ImageSrc"]),void 0,function(){var a=document.createEvent("Event");a.initEvent("load",!1,!1);e.Holder.dispatchEvent(a);e.Holder.loaded=!0})}};return e}function cShape(a,c,d,f){a=new cHolderBase(a,{type:Number(c.properties.fill[1])>0?"div":!1,config:c,pageNo:d,mode:f});if(a.Holder)a.Holder.style.backgroundColor=c.properties.fill[0],$dom.transparent(a.Holder,c.properties.fill[1]);return a}
function cButton(a,c,d,f){var e=new cHolderBase(a,{type:"button",config:c,pageNo:d,mode:f});e.positionate_i=e.positionate;e.positionate=function(){e.positionate_i();if(e.Holder)$dom.addCls(e.Holder,"ButtonHolder"),e.Holder.innerText=c.properties.label||"",e.Holder.style.font=Math.round(e.imgRate*c.properties.fontSize)+"px "+c.properties.fontFamily,e.Holder.style.color=c.properties.color};return e}
function cSlideShow(a,c,d,f){function e(a){function c(a,d,e){e||$dom.move(a,f=="zoom"||Math.round(i-d[0]*b.imgRate/2),Math.round(j-d[1]*b.imgRate/2));$dom.size(a,Math.round(d[0]*b.imgRate),Math.round(d[1]*b.imgRate))}if(a.origWidth){var d=parseInt(b.Holder.style.width),e=d,h=parseInt(b.Holder.style.height),g=h;a.origWidth/a.origHeight>e/g?(g=Math.round(a.origHeight/a.origWidth*e),a.style.marginTop=Math.round((h-g)/2)+"px",a.style.marginLeft=""):(e=Math.round(a.origWidth/a.origHeight*g),a.style.marginLeft=
Math.round((d-e)/2)+"px",a.style.marginTop="");$dom.size(a,e,g);a.style.backgroundSize=e+"px "+g+"px";var i=(parseInt(a.style.marginLeft)||0)+e/2,j=(parseInt(a.style.marginTop)||0)+g/2;c(o,[BUTTON_MEDIA_WIDTH,BUTTON_MEDIA_HEIGHT]);c(l,[BUTTON_MEDIA_WIDTH,BUTTON_MEDIA_HEIGHT]);p&&c(w,[BUTTON_WAY_WIDTH,BUTTON_MEDIA_HEIGHT],!0)}}function j(){p&&b.prop.descriptions!="HIDE"&&b.setDescription(h[(b.itemIndex>0?b.itemIndex:h.length)-1].description)}function g(a){clearTimeout(s);s=setTimeout(function(){if(b.itemIndex>=
h.length)b.itemIndex=0;i();w&&$dom.hide(w)},a||(b.prop.time||5)*1E3)}function m(a){q=!1;b.itemIndex>=h.length?b.prop.repeat||a?g():(b.isPaused&&$dom.hide(o),$dom.show(l)):!b.prop.autoPlay&&!p?$dom.show(o):g()}function i(){b.isPageShowed?!b.isPaused&&!q&&h.length&&(q=!0,t=!1,r?b.preload(function(){j();m(!0)}):$dom.preload(k,b.getSrc(z,h[b.itemIndex++].src),_$subst(TML_IMG_TRANSPARENT,[appConfig.basePath]),function(a){e(a);$dom.transitionEndHandle(n,function(b){$dom.size(b,parseInt(a.style.width),parseInt(a.style.height));
b.origWidth=parseInt(a.style.width);b.origHeight=parseInt(a.style.height);$dom.margin(b,parseInt(a.style.marginLeft)||0,parseInt(a.style.marginTop)||0);b.style.backgroundImage=a.style.backgroundImage;b.style.backgroundSize=a.style.backgroundSize;$dom.transitionEndHandle(b,function(){$dom.transparent(a,0);m()});$dom.transparent(b,1);j()});$dom.transparent(n,0);$dom.transparent(a,1)}),r=!1):b.stop()}var b=new cHolderBase(a,{type:"div",config:c,pageNo:d,mode:f}),n=b.Holder.appendChild(document.createElement("DIV")),
k=b.Holder.appendChild(document.createElement("DIV")),h,l=document.createElement("div"),o=document.createElement("div"),q,p=c.type,s,t=!1,r=!1;$dom.transparent(n,1);$dom.transparent(k,0);b.mode=f;o.id="Play";b.Holder.appendChild(o);l.id="Replay";b.Holder.appendChild(l);b.itemIndex=c.properties.itemIndex;b.prop=c.properties;var z=b.prop.srcType.toLowerCase();if(p){var w=document.createElement("div"),v=new cActionController(b.Holder),x,y;n.appendChild(w);var u=function(){w.className="Button"+(t?"Prev":
"Next");$dom.show(w)};v.touchStart_i=v.touchStart;v.touchStart=function(a){v.touchStart_i(a);x=a.x||a.x!=0&&a.changedTouches[0].pageX};v.touchMove_i=v.touchMove;v.touchMove=function(a){y=a.x||a.x!=0&&a.changedTouches[0].pageX;t=x<y;v.touchMove_i(a)&&!q&&!b.isReplayShowed&&!b.isPaused&&u(a)};v.touchEnd_i=v.touchEnd;v.touchEnd=function(a){y=a.x||a.x!=0&&a.changedTouches[0].pageX;t=x<y;if(v.touchEnd_i(a)&&!q&&!b.isReplayShowed&&!b.isPaused){u(a);if(t)b.itemIndex=b.itemIndex-2<0?h.length-1:b.itemIndex-
2;else if(b.index>=h.length)b.itemIndex=0;r=!0;g(100)}}}b.__defineGetter__("isPaused",function(){return o.style.display!="none"});b.__defineGetter__("isReplayShowed",function(){return window.getComputedStyle(l).display!="none"});b.play=function(a){a>-1&&(b.itemIndex=a);$dom.hide(o);g()};b.pause=function(){$dom.show(o);if(b.prop.autoPlay&&!p)o.style.visibility="hidden"};b.stop=function(){$dom.transparent(n,1);$dom.transparent(k);b.itemIndex=0;h&&b.preload(function(){j();$dom.hide(l);b.pause();q=!1})};
b.Holder.addEventListener("click",function(d){w&&$dom.hide(w);d.preventDefault();d.stopPropagation();if(p)if(b.isReplayShowed)b.stop(),b.play();else if(b.isPaused)b.play();else{var d=d.x||d.x!=0&&d.changedTouches[0].pageX,e=b.Holder.offsetWidth/2-n.offsetWidth*0.3,f=b.Holder.offsetWidth/2+n.offsetWidth*0.3;if(d<e||d>f){if(r=!0,!q)d<e?(b.itemIndex=b.itemIndex-2<0?h.length-1:b.itemIndex-2,g(100),t=!0,u()):(u(),g(100))}else $dom.show(o)}else a.mngHolders.eventHandlers.openSlideshowInWindow(c.properties,
b),b.isReplayShowed?b.stop():b.pause()});b.setDescription=function(){};b.positionate_i=b.positionate;b.positionate=function(){if(p){b.imgRate=b.dim.thlWidth/a.mngBook._imgSizes[2];var c=b.position=[0,0,a.getPageSize("Width"),a.getPageSize("Height")-TOP_TOOL_BAR_HEIGHT];if(b.Holder)b.Holder.className="Holder",$dom.move(b.Holder,c[0],c[1]),$dom.size(b.Holder,c[2],c[3])}else b.positionate_i();$dom.addCls(b.Holder,"SlideShow");e(n);e(k)};b.preload=function(c){if(h.length){if(f=="zoom")b.itemIndex=a.mngHolders.getHolderPropertyValue("page",
d,b.i,"itemIndex")-1;$dom.preload(n,b.getSrc(z,h[b.itemIndex++].src),null,function(a){e(a);c()})}};b.onShowed_i=b.onShowed;b.onShowed=function(){b.onShowed_i();h=b.prop.slideShowItems;if(h.length){if(!b.itemIndex||b.itemIndex<0||b.index>=h.length)b.itemIndex=0;n.style.backgroundImage?b.prop.autoPlay&&b.isPaused&&b.play():b.preload(function(){b.prop.autoPlay?b.play():b.pause()});j()}};b.remove_i=b.remove;b.remove=function(a){b.stop();b.remove_i(a)};return b}
new function(a){var c,d,f;function e(){function a(b,c){for(var d=0;d<b.length;d++)for(var e=0;e<c.length;e++)if(c[e].id.indexOf(b[d])>=0&&(c[e].showed=!0,$dom.replaceCls(c[e],"imm","showDefault"),e!=d)){$dom.swapNode(c[e],c[d]);var f=c[e];c[e]=c[d];c[d]=f}for(d=0;d<c.length;d++)c[d].showed||$dom.hide(c[d])}var c=b.mngBook.settings;if(!c||!c.controlBarButtons||!c.menuButtons)c={controlBarButtons:["Text","Menu","Zoom"],menuButtons:["Index","Search","Share","Bookmarks","GoTo"]};if(c.controlBarButtons)for(var d=
_$(".cp",null,!1,!0),e=0;e<d.length;e++)a(c.controlBarButtons,$dom.collToArray(_$(".imm",d[e],!1,!0)));c.menuButtons&&a(c.menuButtons,$dom.collToArray(_$("#cpm>LI",null,!1,!0)))}function j(){function a(b){for(var c=document.getElementsByTagName("link"),d=0;d<c.lenght;d++)if(c[d].rel==b)return!1;return!0}$dom.addCls(document.body,"iOS");var b=_$("head"),c,d={"apple-mobile-web-app-capable":"yes","apple-mobile-web-app-status-bar-style":"black","apple-touch-fullscreen":"yes"},e={"apple-touch-icon":"apple-touch-icon.png",
"apple-touch-startup-image":"apple-touch-startup.png"},f;for(f in d)if(document.getElementsByName(f).lenght<=0)c=document.createElement("meta"),c.name=f,c.content=d[f],b.appendChild(c);for(f in e)if(a(f))c=document.createElement("link"),c.rel=f,c.href=e[f],b.appendChild(c)}function g(a){var c=_$get(appConfig.basePath+"tmpl/default/body.htm"),d;for(d in b.labels)c=c.replaceTags(b.labels[d]);a.innerHTML=c.replaceTags(b.mngBook.internalTags);return a}function m(a,c){if(c)b[a]?$log.warn('"eMagReader.'+
a+'" manager is already defined.'):b[a]=new c(b);else return $log.error('"'+/(\w+)\(/.exec(c.toString())[1]+'" class is undefined.'),!1;b[a].load()}function i(){$dom.margin(n.msg,b.getPageSize("Width")/2-100,b.getPageSize("Height")/2-n.msg.clientHeight/2)}var b=this,n,k;b.useStorage=!0;b.context=a;b[STARTUP_POINT]=function(){c=void 0;d=void 0;f=void 0;a.cache={};b.disabled=!0;$ua.iP()&&j();var e=_$("#splashScreen"),g=e.childNodes[0];$dom.size(e,b.getPageSize("Width"),b.getPageSize("Height")+100);
$dom.move(g,b.getPageSize("Width")/2-g.clientWidth/2,b.getPageSize("Height")/2-g.clientHeight/2);m("mngBook",cBookManager)};b.onLoadData=function(){n=$dom.init(g(_$("#content",document,!0)),b,{reader:b.pagerID,ctr:"#container",splash:"#splashScreen",msg:"#splashWnd",prompt:"#prompt"});if(!top.eMagReader&&!$ua.allowed())b.showAlert("lblBrowserError",!1,!1);else{m("mngScroll",cScrollManager);m("mngScreenPager",cScreenPager);m("mngSearch",cSearchScreen);m("mngSocial",cShareScreen);m("mngTextReader",
cTextReader);m("mngIndex",cIndexScreen);m("mngZoom",cZoomManager);m("mngSecurity",cSecurityManager);m("mngBookmark",cBookmarkScreen);m("mngHolders",cHolderManager);m("mngPageFlipper",cPageFlipper);m("mngOrient",cOrientation);try{e();k=b.mngPageFlipper.init();b.disabled=!1;n.splash.innerHTML="";b.doLayout(b.isRegularCall&&b.mngBook.getUhashPage()<0);var a=b.mngBook.curPage;b.mngHolders.eventHandlers.onEnterPage(a);if(b.mngOrient.landscape)b.mngHolders.eventHandlers.onEnterPage(a+(a%2?-1:1))}catch(c){b.disabled=
!0,$log.error("init page reader error: "+c.message),b.showAlert("Initialization error. Please reload application.")}}};b.unLoadData=function(){b.disabled=!0;delete k;k=void 0;a.location.hash="";document.body.className=""};b.scroll=function(b){b?setTimeout(a.scrollTo,0,0,1):a.scrollTo(0,1)};b.doPaging=function(a){function c(a,d){$dom.updateCls(_$("#cp"+(b.mngOrient.isLandscape?"v":"h")+"Pg"+a),"cDisabled",d)}b.mngTextReader.invalidate();k.doPaging(a);b.mngZoom.isShowed&&b.mngZoom.invalidate();c("Prev",
b.mngBook.isFirst);c("Next",b.mngBook.isLast)};b.getThumbnailSize=function(a){if(!c){c={0:{Height:1/b.mngBook.imgRatio,Width:0},1:{Width:b.mngBook.imgRatio,Height:0}}[Number(b.getThumbnailWrapperSize("Width")/b.getThumbnailWrapperSize("Height")>b.mngBook.imgRatio)];for(var d in c)if(e)c[d]=b.getThumbnailWrapperSize(d)-c[d],c[e]=Math.round(c[e]*c[d]);else var e=d}return c[a]};b.getThumbnailWrapperSize=function(a){if(!d){d={Width:b.mngBook.pageStep,Height:1};for(var c in d)d[c]=Math.ceil(b.getReaderSize(c)/
d[c])}return d[a]};b.getReaderSize=function(a){if(!f){var c=b.mngBook.settings.hideControlbar?0:CP_W,d=b.mngBook.settings.showPageNumbers?15:0;f={0:{Width:c,Height:d},1:{Height:c+d,Width:0}}[Number(!b.mngOrient.isLandscape)];for(var e in f)f[e]=b.getPageSize(e)-f[e]}return f[a]};b.getPageSize=function(c){return b[c]||a["inner"+c]};b.invalidate=function(){if(k){c=void 0;d=void 0;f=void 0;$dom.size(n.splash,b.getPageSize("Width"),b.getPageSize("Height"));i();for(var a=_$(".s100",null,!1,!0),e=0;e<a.length;e++)$dom.size(a[e],
b.getPageSize("Width"),b.getPageSize("Height"));b.mngHolders.invalidate();k.invalidateThumbnails();b.mngScroll.invalidate();b.mngTextReader.doLayout();b.mngIndex.doLayout();b.doPaging(!0);b.mngSecurity.invalidate()}};b.doLayout=function(a){if(b.disabled)return b.invalidate();b.showAlert(a?"lblInstructionLabel":"lblLoading",a,a);b.isReaderActive?($dom.transitionEndHandle(n.ctr,function(a){b.invalidate();$dom.transitionEndHandle(a,b.hideAlert);$dom.transparent(a,1)}),$dom.transparent(n.ctr,0)):(b.invalidate(),
b.hideAlert())};b.showPrompt=function(a,b,c){function d(a){a=a?"hide":"show";$dom[a](n.prompt);$dom[a](n.splash)}_$(".message",n.prompt).innerHTML=a;var e=_$(".inputWrap INPUT",n.prompt);e.placeholder=b;e.addEventListener("keydown",function(a){a.keyCode==13&&c(e.value)&&d(!0)});_$("#ok",n.prompt).addEventListener("click",function(){c(e.value)&&d(!0)});_$("#Cancel",n.prompt).addEventListener("click",d);d();e.focus()};b.showAlert=function(a,c,d,e){if(n.msg.locked)return!1;b.scroll();n.msg.locked=e;
n.msg.innerHTML=b.loc(a).replace(/(\n)/gm,"<br>");d&&$dom.show(n.splash);$dom.show(n.msg);i();n.msg.closeOnClick=c;if(!n.msg._inited)a=function(){if(n.msg.closeOnClick)n.msg.closeOnClick=!1,b.hideAlert()},n.splash.addEventListener("click",a),n.msg.addEventListener("click",a),n.msg._inited=!0;return!0};b.hideAlert=function(){!n.msg.closeOnClick&&!n.msg.locked&&($dom.hide(n.splash),$dom.hide(n.msg))};b.loc=function(a,c,d){a=b.labels[d||"other"][a]||b.labels.general[a]||a;return c?_$subst(a,c):a};b.handleEvent=
function(a){try{b[a.type](a)}catch(c){$log.error(c.stack||c)}};b.__defineGetter__("disabled",function(){return b.__disabled__});b.__defineSetter__("disabled",function(a){b.__disabled__=a;if(k)k.disabled=a});b.__defineGetter__("isTest",function(){return!RELEASE&&!a.STARTUP_METHOD});b.__defineGetter__("isRegularCall",function(){return!b.isTest&&!a.STARTUP_METHOD});b.__defineGetter__("isReaderActive",function(){return n.msg.style.display!="block"&&n.prompt.style.display!="block"&&b.mngScreenPager.hist.length<=
1});b.isPageShowed=function(a){var c=b.mngBook.curPage;return a==c||b.mngOrient.landscape&&a+(a%2?-1:1)==c};b.__defineGetter__("pagerType",function(){return{flipping:PT_2DWEB_KIT,sliding:PT_SCROLL}[b.mngBook.settings.viewMode||"sliding"]});b.__defineGetter__("pagerID",function(){return"#"+["","f","c","t"][b.pagerType]+"rdr"});(function(c){for(var d=0;d<c.length;d++)b[c[d]]&&a.addEventListener(c[d],b)})(["DOMContentLoaded","scroll"]);a.ss=[b,m,STARTUP_POINT,261,!0,void 0]}(window);